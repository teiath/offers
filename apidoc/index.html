

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>coupons 1.0.0 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="None" href="index.html#document-index" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li><a href="index.html#document-index">coupons 1.0.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="welcome-to-coupons-documentation">
<h1>Welcome to coupons&#8217; documentation!<a class="headerlink" href="#welcome-to-coupons-documentation" title="Permalink to this headline">¶</a></h1>
<p>Contents:</p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-installation">Coupons Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-api">Coupons API reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-schema">Coupons Schema</a></li>
</ul>
<div class="toctree-wrapper compound">
<span id="document-installation"></span><div class="section" id="coupons-installation">
<h2>Coupons Installation<a class="headerlink" href="#coupons-installation" title="Permalink to this headline">¶</a></h2>
<p>Installation instructions for coupons web application.</p>
<div class="section" id="dependencies">
<h3>Dependencies<a class="headerlink" href="#dependencies" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>php &gt;= 5.3.x</li>
<li>mysql &gt;= 5.1.x <em>(also tested with MariaDB &gt;= 5.2.x)</em></li>
<li>python-sphinx <em>(to build documentation)</em></li>
<li>git <em>(to clone directly from the repository)</em></li>
</ul>
<p>Required php modules:</p>
<ul class="simple">
<li>gd</li>
<li>ldap</li>
<li>mysql-pdo</li>
<li>openssl</li>
<li>soap</li>
</ul>
</div>
<div class="section" id="get-source-code">
<h3>Get source code<a class="headerlink" href="#get-source-code" title="Permalink to this headline">¶</a></h3>
<p>Get the source code from the git repository <em>(clone)</em> or a release tag.
Also, the CakePHP bootstrap-helper is required, see <a class="reference internal" href="#deploy">Deploy</a> on how to
download it as a git submodule or from a relsease tag.</p>
<p>Repositories:</p>
<ul class="simple">
<li><a class="reference external" href="http://git.edu.teiath.gr/coupons.git">Coupons (contains CakePHP framework)</a></li>
<li>Coupons on github <em>(pending)</em></li>
<li><a class="reference external" href="http://git.edu.teiath.gr/coupons-docs.git">Coupons documentation</a></li>
<li><a class="reference external" href="https://github.com/cakephp/cakephp">CakePHP framework</a></li>
<li><a class="reference external" href="https://github.com/loadsys/twitter-bootstrap-helper">CakePHP bootstrap-helper</a></li>
</ul>
</div>
<div class="section" id="deploy">
<h3>Deploy<a class="headerlink" href="#deploy" title="Permalink to this headline">¶</a></h3>
<p>Application setup:</p>
<ul class="simple">
<li>List of required configuration files and a list of the most important options.</li>
<li>Permissions.</li>
<li>Git submodules.</li>
</ul>
<div class="section" id="configuration-files">
<h4>Configuration files<a class="headerlink" href="#configuration-files" title="Permalink to this headline">¶</a></h4>
<p>Rename each <tt class="docutils literal"><span class="pre">*.php.default</span></tt> file to <tt class="docutils literal"><span class="pre">*.php</span></tt> and edit accordingly if required.</p>
<ul>
<li><p class="first"><strong>bootstrap.php.default</strong></p>
</li>
<li><p class="first"><strong>configuration.php.default</strong></p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">APP_URL</span></tt>: set the application url <cite>(eg: http://coupons.edu.teiath.gr)</cite> <strong>no</strong> trailing slash here.</li>
<li><tt class="docutils literal"><span class="pre">ISSUE_URL</span></tt>: redmine url</li>
<li><tt class="docutils literal"><span class="pre">ISSUE_TOKEN</span></tt>: redmine&#8217;s user access token</li>
<li><tt class="docutils literal"><span class="pre">ISSUE_PROJECT_ID</span></tt>: redmine project id to post issues to <cite>(project must have an issue tracker)</cite>.</li>
<li><tt class="docutils literal"><span class="pre">ADMIN_EMAIL</span></tt>: email for application&#8217;s administrator</li>
<li><tt class="docutils literal"><span class="pre">MAX_OFFER_IMAGES</span></tt>: maximum number of images allowed in offers.</li>
<li><tt class="docutils literal"><span class="pre">MAX_COMPANY_IMAGES</span></tt>: maximum number of images allowed in company profile.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><strong>core.php.default</strong></p>
<blockquote>
<div><ul class="simple">
<li>contains salt and hash algorithm settings - keep it safe.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><strong>database.php.default</strong></p>
<blockquote>
<div><ul class="simple">
<li>database settings - set database name/credentials</li>
<li><tt class="docutils literal"><span class="pre">encoding</span></tt>: set to <tt class="docutils literal"><span class="pre">utf8</span></tt>.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><strong>email.php.default</strong></p>
<blockquote>
<div><ul class="simple">
<li>configure application email address / email charset etc</li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><strong>ldap.php.default</strong></p>
<blockquote>
<div><ul class="simple">
<li>LDAP settings - set ldap credentials here</li>
<li>if using LDAP with SSL remember that the <tt class="docutils literal"><span class="pre">port</span></tt> should remain empty and all parameters should
be in the <tt class="docutils literal"><span class="pre">server</span></tt> directive in a form of url. eg: <tt class="docutils literal"><span class="pre">ldaps://foo.com:port</span></tt>.
See: <a class="reference external" href="http://gr2.php.net/manual/en/function.ldap-connect.php">ldap_connect()</a>.</li>
</ul>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="permissions">
<h4>Permissions<a class="headerlink" href="#permissions" title="Permalink to this headline">¶</a></h4>
<p>The following folders must be writable from the <tt class="docutils literal"><span class="pre">http</span></tt> user (or the relevant user that run the webserver).:</p>
<div class="highlight-python"><pre>app
|-- tmp
    |-- cache
    |   |-- models
    |   |-- persistent
    |   `-- views
    `-- logs</pre>
</div>
</div>
<div class="section" id="git-submodules">
<h4>Git submodules<a class="headerlink" href="#git-submodules" title="Permalink to this headline">¶</a></h4>
<p>The application&#8217;s front-end uses <a class="reference external" href="http://twitter.github.com/bootstrap">Twitter&#8217;s Bootstrap</a> through a <a class="reference external" href="https://github.com/loadsys/twitter-bootstrap-helper">CakePHP helper</a>.
This helper is not optional. It resides inside the <tt class="docutils literal"><span class="pre">plugins</span></tt> folder found in the
project&#8217;s root directory as a <a class="reference external" href="http://git-scm.com/book/en/Git-Tools-Submodules">git submodule</a>. In order to fetch the helper, after
the first clone run:</p>
<div class="highlight-python"><pre>$ git submodule init
$ git submodule update</pre>
</div>
<p>To keep up-to-date run:</p>
<div class="highlight-python"><pre>$ git submodule foreach git pull</pre>
</div>
<p>Note that this will fetch any other posible git submodules used by the application.
See the <a class="reference external" href="http://git.edu.teiath.gr/coupons.git/tree/.gitmodules">project&#8217;s .gitmodules</a> file for more information.</p>
</div>
</div>
<div class="section" id="database">
<h3>Database<a class="headerlink" href="#database" title="Permalink to this headline">¶</a></h3>
<p>Database setup:</p>
<ul class="simple">
<li>From command line</li>
<li>From PHPMyAdmin</li>
</ul>
<div class="section" id="from-command-line">
<h4>From command line<a class="headerlink" href="#from-command-line" title="Permalink to this headline">¶</a></h4>
<p>Run the setup script found in <tt class="docutils literal"><span class="pre">schema/reset-db.sh</span></tt> and provide the root username/password
for your database when prompted. The database scripts assume you have the right to create
databases. The default database created is named <tt class="docutils literal"><span class="pre">opendeals</span></tt>.</p>
</div>
<div class="section" id="from-phpmyadmin">
<h4>From PHPMyAdmin<a class="headerlink" href="#from-phpmyadmin" title="Permalink to this headline">¶</a></h4>
<ol class="arabic simple">
<li>import <tt class="docutils literal"><span class="pre">opendeals.sql</span></tt></li>
<li>import <tt class="docutils literal"><span class="pre">days.sql</span></tt></li>
<li>import <tt class="docutils literal"><span class="pre">counties.csv</span></tt>, skiping the 1st row</li>
<li>import <tt class="docutils literal"><span class="pre">municipalities.csv</span></tt> skipping the 1st row and re-arranging columns properly</li>
<li>import <tt class="docutils literal"><span class="pre">offercategories.sql</span></tt></li>
</ol>
</div>
</div>
<div class="section" id="cron-scripts">
<h3>Cron scripts<a class="headerlink" href="#cron-scripts" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first"><strong>new_offers.sh</strong></p>
<blockquote>
<div><ul class="simple">
<li>notify users for new offers</li>
<li>run: <tt class="docutils literal"><span class="pre">once</span> <span class="pre">/</span> <span class="pre">day</span></tt> a little after <tt class="docutils literal"><span class="pre">00:00</span></tt>.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><strong>notify_improper.sh</strong></p>
<blockquote>
<div><ul class="simple">
<li>notify users for offers marked as spam (only if user has related coupons)</li>
<li>run every: <tt class="docutils literal"><span class="pre">6</span> <span class="pre">hours</span></tt>.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><strong>remove_old_visits.sh</strong></p>
<blockquote>
<div><ul class="simple">
<li>cleanup old status</li>
<li>run every: <tt class="docutils literal"><span class="pre">3</span> <span class="pre">days</span></tt> or longer.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><strong>update_state.sh</strong></p>
<blockquote>
<div><ul class="simple">
<li>check offer end time and mark finished offers as &#8220;finished&#8221;</li>
<li>run at least every: <tt class="docutils literal"><span class="pre">15</span> <span class="pre">min</span></tt>.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><strong>update_total_stats.sh</strong></p>
<blockquote>
<div><ul class="simple">
<li>calculate total stats for previous day</li>
<li>run: <tt class="docutils literal"><span class="pre">once</span> <span class="pre">/</span> <span class="pre">day</span></tt> a little after <tt class="docutils literal"><span class="pre">00:00</span></tt>.</li>
</ul>
</div></blockquote>
</li>
</ul>
</div>
</div>
<span id="document-api"></span><div class="section" id="coupons-api-reference">
<h2>Coupons API reference<a class="headerlink" href="#coupons-api-reference" title="Permalink to this headline">¶</a></h2>
<div class="section" id="summary">
<h3>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h3>
<p>Το domain που χρησιμοποιείται για όλες τις κλήσεις είναι το:</p>
<div class="highlight-python"><pre>https://coupons.teiath.gr/api</pre>
</div>
<p>το οποίο στις παρακάτω ενότητες αντικαθίσταται με το λεκτικό <strong>&lt;url&gt;</strong>.</p>
<p>Τα διαθέσιμα HTTP methods είναι τα εξής:</p>
<ul class="simple">
<li><strong>GET</strong></li>
<li><strong>POST</strong></li>
<li><strong>PUT</strong></li>
<li><strong>DELETE</strong></li>
</ul>
</div>
<div class="section" id="login">
<h3>Login<a class="headerlink" href="#login" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="40%" />
<col width="47%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Method</th>
<th class="head">Rest URI</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>POST</td>
<td>url/<strong>users/login</strong></td>
<td>Login user in service.</td>
</tr>
</tbody>
</table>
<p>XML Request body:</p>
<div class="highlight-python"><pre>&lt;User&gt;
    &lt;username&gt;foo&lt;/username&gt;
    &lt;password&gt;bar&lt;/password&gt;
&lt;/User&gt;</pre>
</div>
<p>JSON Request body:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>
    <span class="s">&quot;User&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">&quot;username&quot;</span><span class="p">:</span> <span class="s">&quot;foo&quot;</span><span class="p">,</span>
        <span class="s">&quot;passsword&quot;</span><span class="p">:</span> <span class="s">&quot;bar&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Sample XML request:</p>
<div class="highlight-python"><pre>$ curl -X POST http://coupons.edu.teiath.gr/api/users/login \
    -H &quot;Content-Type: application/xml&quot; \
    -H &quot;Accept: application/xml&quot; \
    -d &quot;&lt;User&gt;&lt;username&gt;foo&lt;/username&gt;&lt;password&gt;bar&lt;/password&gt;&lt;/User&gt;&quot; \
    -c /tmp/cookie</pre>
</div>
<p>Sample JSON request:</p>
<div class="highlight-python"><pre>$ curl -X POST http://coupons.edu.teiath.gr/api/users/login \
    -H &quot;Content-Type: application/json&quot; \
    -H &quot;Accept: application/json&quot; \
    -d &#x27;{&quot;User&quot;: {&quot;username&quot;: &quot;foo&quot;, &quot;password&quot;: &quot;bar&quot;}}&#x27; \
    -c /tmp/cookie</pre>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Τα παραπάνω request δημιουργούν ένα αρχείο cookies <tt class="docutils literal"><span class="pre">cookie</span></tt> στον κατάλογο <tt class="docutils literal"><span class="pre">tmp</span></tt>.
Χρησιμοποιείται για τα requests τα οποία απαιτούν αυθεντικοποίηση.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Χρησιμοποιήστε μόνο διπλά quotes <tt class="docutils literal"><span class="pre">&quot;</span></tt> στο JSON. Εξωτερικά απαιτούνται μονά quotes <tt class="docutils literal"><span class="pre">'</span></tt> για αποφυγή expansion από το shell.</p>
</div>
<p>Sample JSON response on success:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>
    <span class="s">&quot;message&quot;</span><span class="p">:</span> <span class="s">&quot;Η αυθεντικοποίηση ολοκληρώθηκε με επιτυχία&quot;</span><span class="p">,</span>
    <span class="s">&quot;status_code&quot;</span><span class="p">:</span> <span class="mi">200</span>
<span class="p">}</span>
</pre></div>
</div>
<p>and on wrong credenials:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>
    <span class="s">&quot;message&quot;</span><span class="p">:</span> <span class="s">&quot;Δώστε έγκυρο όνομα και κωδικό χρήστη&quot;</span><span class="p">,</span>
    <span class="s">&quot;status_code&quot;</span><span class="p">:</span> <span class="mi">403</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="offer-index-listing">
<h3>Offer Index (listing)<a class="headerlink" href="#offer-index-listing" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="4%" />
<col width="17%" />
<col width="79%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Method</th>
<th class="head">Rest URI</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>GET</td>
<td>url/<strong>offers</strong></td>
<td>Retrieve list of publicly available offers. By default returns 1st page of results only. Also see <a class="reference internal" href="#request-options">Request options</a>.</td>
</tr>
</tbody>
</table>
<p>Sample JSON request:</p>
<div class="highlight-python"><pre>$ curl -X GET http://url/offers -H &quot;Accept: application/json&quot;</pre>
</div>
<p>Sample JSON response:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>
    <span class="s">&quot;companies&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s">&quot;address&quot;</span><span class="p">:</span> <span class="s">&quot;οδός Ρόδων 45&quot;</span><span class="p">,</span>
            <span class="s">&quot;afm&quot;</span><span class="p">:</span> <span class="s">&quot;011111111&quot;</span><span class="p">,</span>
            <span class="s">&quot;created&quot;</span><span class="p">:</span> <span class="s">&quot;2012-04-17 09:24:38&quot;</span><span class="p">,</span>
            <span class="s">&quot;fax&quot;</span><span class="p">:</span> <span class="s">&quot;2107654321&quot;</span><span class="p">,</span>
            <span class="s">&quot;id&quot;</span><span class="p">:</span> <span class="s">&quot;4&quot;</span><span class="p">,</span>
            <span class="s">&quot;image_count&quot;</span><span class="p">:</span> <span class="s">&quot;0&quot;</span><span class="p">,</span>
            <span class="s">&quot;is_enabled&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
            <span class="s">&quot;latitude&quot;</span><span class="p">:</span> <span class="s">&quot;37.94471&quot;</span><span class="p">,</span>
            <span class="s">&quot;longitude&quot;</span><span class="p">:</span> <span class="s">&quot;23.76706&quot;</span><span class="p">,</span>
            <span class="s">&quot;modified&quot;</span><span class="p">:</span> <span class="s">&quot;2012-04-17 09:24:38&quot;</span><span class="p">,</span>
            <span class="s">&quot;municipality_id&quot;</span><span class="p">:</span> <span class="s">&quot;144&quot;</span><span class="p">,</span>
            <span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="s">&quot;Pizza Fan&quot;</span><span class="p">,</span>
            <span class="s">&quot;phone&quot;</span><span class="p">:</span> <span class="s">&quot;2108112000&quot;</span><span class="p">,</span>
            <span class="s">&quot;postalcode&quot;</span><span class="p">:</span> <span class="s">&quot;12345&quot;</span><span class="p">,</span>
            <span class="s">&quot;service_type&quot;</span><span class="p">:</span> <span class="s">&quot;Υπηρεσίες&quot;</span><span class="p">,</span>
            <span class="s">&quot;user_id&quot;</span><span class="p">:</span> <span class="s">&quot;9&quot;</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="s">&quot;offers&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s">&quot;autoend&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
            <span class="s">&quot;autostart&quot;</span><span class="p">:</span> <span class="s">&quot;2012-07-14 18:00:00&quot;</span><span class="p">,</span>
            <span class="s">&quot;company_id&quot;</span><span class="p">:</span> <span class="s">&quot;4&quot;</span><span class="p">,</span>
            <span class="s">&quot;coupon_count&quot;</span><span class="p">:</span> <span class="s">&quot;0&quot;</span><span class="p">,</span>
            <span class="s">&quot;coupon_terms&quot;</span><span class="p">:</span> <span class="s">&quot;Εξαργύρωση μόνο μετά την λήξη&quot;</span><span class="p">,</span>
            <span class="s">&quot;created&quot;</span><span class="p">:</span> <span class="s">&quot;2012-04-17 12:49:56&quot;</span><span class="p">,</span>
            <span class="s">&quot;description&quot;</span><span class="p">:</span> <span class="s">&quot;40% για τους φοιτητές.&quot;</span><span class="p">,</span>
            <span class="s">&quot;ended&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
            <span class="s">&quot;id&quot;</span><span class="p">:</span> <span class="s">&quot;17&quot;</span><span class="p">,</span>
            <span class="s">&quot;image_count&quot;</span><span class="p">:</span> <span class="s">&quot;0&quot;</span><span class="p">,</span>
            <span class="s">&quot;is_spam&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
            <span class="s">&quot;max_per_student&quot;</span><span class="p">:</span> <span class="s">&quot;0&quot;</span><span class="p">,</span>
            <span class="s">&quot;modified&quot;</span><span class="p">:</span> <span class="s">&quot;2012-04-17 12:49:56&quot;</span><span class="p">,</span>
            <span class="s">&quot;offer_category&quot;</span><span class="p">:</span> <span class="s">&quot;Φαγητό&quot;</span><span class="p">,</span>
            <span class="s">&quot;offer_hours&quot;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="s">&quot;offer_state&quot;</span><span class="p">:</span> <span class="s">&quot;active&quot;</span><span class="p">,</span>
            <span class="s">&quot;offer_type&quot;</span><span class="p">:</span> <span class="s">&quot;limited&quot;</span><span class="p">,</span>
            <span class="s">&quot;started&quot;</span><span class="p">:</span> <span class="s">&quot;2012-01-01 00:00:00&quot;</span><span class="p">,</span>
            <span class="s">&quot;student_vote&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s">&quot;vote_type&quot;</span><span class="p">:</span> <span class="mi">0</span>
            <span class="p">},</span>
            <span class="s">&quot;student_coupon&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s">&quot;enabled&quot;</span><span class="p">:</span> <span class="mi">0</span>
            <span class="p">},</span>
            <span class="s">&quot;tags&quot;</span><span class="p">:</span> <span class="s">&quot;pizza fan πίτσα&quot;</span><span class="p">,</span>
            <span class="s">&quot;title&quot;</span><span class="p">:</span> <span class="s">&quot;Pizza Fan 40 τοις εκατό&quot;</span><span class="p">,</span>
            <span class="s">&quot;total_quantity&quot;</span><span class="p">:</span> <span class="s">&quot;0&quot;</span><span class="p">,</span>
            <span class="s">&quot;vote_count&quot;</span><span class="p">:</span> <span class="s">&quot;0&quot;</span><span class="p">,</span>
            <span class="s">&quot;vote_sum&quot;</span><span class="p">:</span> <span class="s">&quot;0&quot;</span>
        <span class="p">},</span>
    <span class="p">],</span>
    <span class="s">&quot;pagination&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">&quot;count&quot;</span><span class="p">:</span> <span class="mi">157</span><span class="p">,</span>
        <span class="s">&quot;current&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
        <span class="s">&quot;limit&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
        <span class="s">&quot;nextPage&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
        <span class="s">&quot;options&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s">&quot;conditions&quot;</span><span class="p">:</span> <span class="p">[]</span>
        <span class="p">},</span>
        <span class="s">&quot;order&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s">&quot;page&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s">&quot;pageCount&quot;</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span>
        <span class="s">&quot;paramType&quot;</span><span class="p">:</span> <span class="s">&quot;named&quot;</span><span class="p">,</span>
        <span class="s">&quot;prevPage&quot;</span><span class="p">:</span> <span class="n">false</span>
    <span class="p">},</span>
    <span class="s">&quot;status_code&quot;</span><span class="p">:</span> <span class="mi">200</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Για κάθε προσφορά επιστρέφονται και τα αντίστοιχα στοιχεία της επιχείρησης.
Τα στοιχεία αυτά επιστρέφονται σε μια δεύτερη λίστα με το όνομα <tt class="docutils literal"><span class="pre">companies</span></tt>.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>Το πεδίο <tt class="docutils literal"><span class="pre">ended</span></tt> συμπληρώνεται μετά το πέρας της προσφοράς.</li>
<li>Το πεδίο <tt class="docutils literal"><span class="pre">autoend</span></tt> δέν έχει νόημα για τις κατηγορίες προσφορών happy hour και coupons.</li>
<li>Το πεδίο <tt class="docutils literal"><span class="pre">autostart</span></tt> δέν έχει νόημα για την κατηγορία προσφορών happy hour.</li>
</ul>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Το πεδιο <tt class="docutils literal"><span class="pre">student_vote</span></tt> είναι διαθέσιμο μόνο σε σπουδαστές και μόνο μετά από σύνδεση στο σύστημα.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>Το πεδίο <tt class="docutils literal"><span class="pre">student_coupon</span></tt> είναι διαθέσιμο μόνο σε σπουδαστές, μετά απο σύνδεση στο σύστημα και
έχει νόημα μόνο για προσφορές τύπου <tt class="docutils literal"><span class="pre">coupons</span></tt>.</li>
<li>Οι δυνατές τιμές είναι 0 και 1 οι οποίες υποδηλώνουν ότι ο χρήστης δεν μπορεί ή μπορεί να δεσμεύσει
κουπόνι αντίστοιχα.</li>
<li>Σε άλλου τύπου προσφορές ή αν ο χρήστης δεν είναι συνδεδεμένος το πεδίο απουσιάζει</li>
</ul>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Οι τιμές των πεδίων <cite>vote_type</cite> συνοψίζονται στην ενότητα  <a class="reference internal" href="#offer-vote">Offer Vote</a> .</p>
</div>
</div>
<div class="section" id="request-options">
<h3>Request options<a class="headerlink" href="#request-options" title="Permalink to this headline">¶</a></h3>
<p>Παράμετροι που χρησιμοποιούνται στα web requests.</p>
<table border="1" class="docutils">
<colgroup>
<col width="15%" />
<col width="16%" />
<col width="70%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sort keyword</th>
<th class="head">Sort value</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>orderby</td>
<td><em>recent</em></td>
<td>Sort by recent additions</td>
</tr>
<tr class="row-odd"><td>orderby</td>
<td><em>rank</em></td>
<td>Sort by vote results (sum of votes)</td>
</tr>
<tr class="row-even"><td>orderby</td>
<td><em>votes</em></td>
<td>Sort by vote number (count)</td>
</tr>
<tr class="row-odd"><td>orderby</td>
<td><em>distance</em></td>
<td>Sort by user distance, available only when user coordinates are set</td>
</tr>
<tr class="row-even"><td>page</td>
<td><em>&lt;num&gt;</em></td>
<td>Show only results page number = <em>&lt;num&gt;</em></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Από προεπιλογή επιστρέφεται μόνο η πρώτη σελίδα αποτελεσμάτων.</p>
</div>
<p>Sample JSON request with options:</p>
<div class="highlight-python"><pre>$ curl -X GET http://coupons.edu.teiath.gr/api/offers/index/orderby:rank/page:2 -H &quot;Accept: application/json&quot;</pre>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Για την χρήση παραμέτρων ταξινόμησης απαιτείται στο URI το <strong>index</strong> οταν ζητάμε λίστα όλων των προσφορών.</p>
</div>
</div>
<div class="section" id="offer-types">
<h3>Offer Types<a class="headerlink" href="#offer-types" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="7%" />
<col width="27%" />
<col width="66%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Method</th>
<th class="head">Rest URI</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>GET</td>
<td>url/<strong>offers/happyhour</strong></td>
<td>Retrieve list of publicly available <strong>Happy Hour</strong> offers.</td>
</tr>
<tr class="row-odd"><td>GET</td>
<td>url/<strong>offers/coupons</strong></td>
<td>Retrieve list of publicly available <strong>Coupons</strong> offers.</td>
</tr>
<tr class="row-even"><td>GET</td>
<td>url/<strong>offers/limited</strong></td>
<td>Retrieve list of publicly available <strong>Limited</strong> offers.</td>
</tr>
</tbody>
</table>
<p>Η απάντηση που επιστρέφουν τα παραπάνω URIs είναι αντίστοιχη με της ενότητας <a class="reference internal" href="#offer-index-listing">Offer Index (listing)</a> .</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Υποστηρίζονται όλες οι παράμετροι που αναφέρονται στην ενότητα <a class="reference internal" href="#request-options">Request options</a>.</p>
</div>
</div>
<div class="section" id="offer-categories">
<h3>Offer Categories<a class="headerlink" href="#offer-categories" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="6%" />
<col width="40%" />
<col width="54%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Method</th>
<th class="head">Rest URI</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>GET</td>
<td>url/<strong>offers/category</strong>/<em>{categoryId}</em></td>
<td>Retrieve offers for category with id: <em>{categoryId}</em></td>
</tr>
</tbody>
</table>
<p>Η απάντηση που επιστρέφουν τα παραπάνω URIs είναι αντίστοιχη με της ενότητας <a class="reference internal" href="#offer-index-listing">Offer Index (listing)</a> .</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Υποστηρίζονται όλες οι παράμετροι που αναφέρονται στην ενότητα <a class="reference internal" href="#request-options">Request options</a>.</p>
</div>
</div>
<div class="section" id="offer-view">
<h3>Offer View<a class="headerlink" href="#offer-view" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="8%" />
<col width="36%" />
<col width="56%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Method</th>
<th class="head">Rest URI</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>GET</td>
<td>url/<strong>offer</strong>/<em>{offerId}</em></td>
<td>Retrieve info of offer with id <em>offerId</em></td>
</tr>
</tbody>
</table>
<p>The following table describes the URI parameters.</p>
<table border="1" class="docutils">
<colgroup>
<col width="27%" />
<col width="51%" />
<col width="22%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="3">required parameters</th>
</tr>
<tr class="row-even"><th class="head">Parameter Name</th>
<th class="head">Data type</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-odd"><td>offerId</td>
<td>string</td>
<td>ID of offer</td>
</tr>
</tbody>
</table>
<p>Sample JSON request:</p>
<div class="highlight-python"><pre>$ curl -X GET http://url/offer/17 -H &quot;Accept: application/json&quot;</pre>
</div>
<p>Sample JSON response (offer type <strong>HappyHour</strong>):</p>
<div class="highlight-python"><pre>{
    &quot;company&quot;: {
        &quot;address&quot;: &quot;οδός Ρόδων 45&quot;&quot;,
        &quot;afm&quot;: &quot;011111111&quot;,
        &quot;created&quot;: &quot;2012-04-17 12:29:45&quot;,
        &quot;fax&quot;: &quot;2107654321&quot;,
        &quot;id&quot;: &quot;8&quot;,
        &quot;image_count&quot;: &quot;0&quot;,
        &quot;is_enabled&quot;: true,
        &quot;latitude&quot;: &quot;37.94471&quot;,
        &quot;longitude&quot;: &quot;23.76706&quot;,
        &quot;modified&quot;: &quot;2012-04-17 12:29:45&quot;,
        &quot;municipality_id&quot;: 144,
        &quot;name&quot;: &quot;Άρωμα Βύνης&quot;,
        &quot;phone&quot;: &quot;2100000000&quot;,
        &quot;postalcode&quot;: &quot;12345&quot;,
        &quot;service_type&quot;: &quot;Φαγητό&quot;,
        &quot;user_id&quot;: &quot;13&quot;
    },
    &quot;offer&quot;: {
        &quot;autoend&quot;: null,
        &quot;autostart&quot;: &quot;2012-07-14 18:00:00&quot;,
        &quot;company_id&quot;: &quot;8&quot;,
        &quot;coupon_count&quot;: &quot;0&quot;,
        &quot;coupon_terms&quot;: &quot;Εξαργύρωση μόνο μετά την λήξη&quot;,
        &quot;created&quot;: &quot;2012-04-17 12:35:51&quot;,
        &quot;description&quot;: &quot;Βαρελίσια μπύρα 330ml ΜΟΝΟ 2,5€&quot;,
        &quot;ended&quot;: null,
        &quot;id&quot;: &quot;14&quot;,
        &quot;image_count&quot;: &quot;0&quot;,
        &quot;is_spam&quot;: false,
        &quot;max_per_student&quot;: 5,
        &quot;modified&quot;: &quot;2012-04-17 12:35:51&quot;,
        &quot;offer_category&quot;: &quot;Φαγητό&quot;,
        &quot;offer_hours&quot;: [
            {
                &quot;day_id&quot;: &quot;1&quot;,
                &quot;ending1&quot;: &quot;07:30:00&quot;,
                &quot;ending2&quot;: &quot;22:00:00&quot;,
                &quot;starting1&quot;: &quot;04:30:00&quot;,
                &quot;starting2&quot;: &quot;16:00:00&quot;
            },
            {
                &quot;day_id&quot;: &quot;2&quot;,
                &quot;ending1&quot;: &quot;22:00:00&quot;,
                &quot;starting1&quot;: &quot;06:00:00&quot;
            },
            {
                &quot;day_id&quot;: &quot;3&quot;,
                &quot;ending1&quot;: &quot;18:00:00&quot;,
                &quot;ending2&quot;: &quot;21:30:00&quot;,
                &quot;starting1&quot;: &quot;16:30:00&quot;,
                &quot;starting2&quot;: &quot;18:30:00&quot;
            },
            {
                &quot;day_id&quot;: &quot;4&quot;,
                &quot;ending1&quot;: &quot;14:00:00&quot;,
                &quot;starting1&quot;: &quot;02:00:00&quot;
            }
        ],
        &quot;offer_state&quot;: &quot;active&quot;,
        &quot;offer_type&quot;: &quot;happy hour&quot;,
        &quot;started&quot;: &quot;0000-00-00 00:00:00&quot;,
        &quot;student_vote&quot;: {
            &quot;vote_type&quot;: 1
        },
        &quot;tags&quot;: &quot;άρωμα βύνης&quot;,
        &quot;title&quot;: &quot;Άρωμα Βύνης Happy Hours&quot;,
        &quot;total_quantity&quot;: 50,
        &quot;vote_count&quot;: &quot;0&quot;,
        &quot;vote_sum&quot;: &quot;0&quot;
    },
    &quot;status_code&quot;: 200
}</pre>
</div>
<p>Sample JSON response (offer type <strong>Coupons</strong>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>
    <span class="s">&quot;company&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">&quot;address&quot;</span><span class="p">:</span> <span class="s">&quot;test address 28&quot;</span><span class="p">,</span>
        <span class="s">&quot;afm&quot;</span><span class="p">:</span> <span class="s">&quot;011111111&quot;</span><span class="p">,</span>
        <span class="s">&quot;created&quot;</span><span class="p">:</span> <span class="s">&quot;2012-04-17 12:49:56&quot;</span><span class="p">,</span>
        <span class="s">&quot;fax&quot;</span><span class="p">:</span> <span class="s">&quot;0987654321&quot;</span><span class="p">,</span>
        <span class="s">&quot;id&quot;</span><span class="p">:</span> <span class="s">&quot;1&quot;</span><span class="p">,</span>
        <span class="s">&quot;image_count&quot;</span><span class="p">:</span> <span class="s">&quot;1&quot;</span><span class="p">,</span>
        <span class="s">&quot;is_enabled&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
        <span class="s">&quot;latitude&quot;</span><span class="p">:</span> <span class="s">&quot;37.94471&quot;</span><span class="p">,</span>
        <span class="s">&quot;longitude&quot;</span><span class="p">:</span> <span class="s">&quot;23.76706&quot;</span><span class="p">,</span>
        <span class="s">&quot;modified&quot;</span><span class="p">:</span> <span class="s">&quot;2012-04-17 09:24:38&quot;</span><span class="p">,</span>
        <span class="s">&quot;municipality_id&quot;</span><span class="p">:</span> <span class="s">&quot;13&quot;</span><span class="p">,</span>
        <span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="s">&quot;company_test_1&quot;</span><span class="p">,</span>
        <span class="s">&quot;phone&quot;</span><span class="p">:</span> <span class="s">&quot;1234567890&quot;</span><span class="p">,</span>
        <span class="s">&quot;postalcode&quot;</span><span class="p">:</span> <span class="s">&quot;12345&quot;</span><span class="p">,</span>
        <span class="s">&quot;service_type&quot;</span><span class="p">:</span> <span class="s">&quot;estiatorio&quot;</span><span class="p">,</span>
        <span class="s">&quot;user_id&quot;</span><span class="p">:</span> <span class="s">&quot;5&quot;</span>
    <span class="p">},</span>
    <span class="s">&quot;offer&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">&quot;autoend&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s">&quot;autostart&quot;</span><span class="p">:</span> <span class="s">&quot;2012-07-14 18:00:00&quot;</span><span class="p">,</span>
        <span class="s">&quot;company_id&quot;</span><span class="p">:</span> <span class="s">&quot;1&quot;</span><span class="p">,</span>
        <span class="s">&quot;coupon_count&quot;</span><span class="p">:</span> <span class="s">&quot;0&quot;</span><span class="p">,</span>
        <span class="s">&quot;coupon_terms&quot;</span><span class="p">:</span> <span class="s">&quot;&quot;</span><span class="p">,</span>
        <span class="s">&quot;created&quot;</span><span class="p">:</span> <span class="s">&quot;2012-05-22 12:15:25&quot;</span><span class="p">,</span>
        <span class="s">&quot;description&quot;</span><span class="p">:</span> <span class="s">&quot;100 κουπόνια για έκπτωση σε είδη γραφείου&quot;</span><span class="p">,</span>
        <span class="s">&quot;ended&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s">&quot;id&quot;</span><span class="p">:</span> <span class="s">&quot;18&quot;</span><span class="p">,</span>
        <span class="s">&quot;image_count&quot;</span><span class="p">:</span> <span class="s">&quot;0&quot;</span><span class="p">,</span>
        <span class="s">&quot;is_spam&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
        <span class="s">&quot;max_per_student&quot;</span><span class="p">:</span> <span class="s">&quot;0&quot;</span><span class="p">,</span>
        <span class="s">&quot;modified&quot;</span><span class="p">:</span> <span class="s">&quot;2012-05-22 12:15:25&quot;</span><span class="p">,</span>
        <span class="s">&quot;offer_category&quot;</span><span class="p">:</span> <span class="s">&quot;Προϊόντα&quot;</span><span class="p">,</span>
        <span class="s">&quot;offer_hours&quot;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s">&quot;offer_state&quot;</span><span class="p">:</span> <span class="s">&quot;active&quot;</span><span class="p">,</span>
        <span class="s">&quot;offer_type&quot;</span><span class="p">:</span> <span class="s">&quot;coupons&quot;</span><span class="p">,</span>
        <span class="s">&quot;started&quot;</span><span class="p">:</span> <span class="s">&quot;2012-05-20 14:00:00&quot;</span><span class="p">,</span>
        <span class="s">&quot;student_vote&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s">&quot;vote_type&quot;</span><span class="p">:</span> <span class="n">null</span>
        <span class="p">},</span>
        <span class="s">&quot;student_coupon&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s">&quot;enabled&quot;</span><span class="p">:</span> <span class="mi">1</span>
        <span class="p">},</span>
        <span class="s">&quot;tags&quot;</span><span class="p">:</span> <span class="s">&quot;γραφείο&quot;</span><span class="p">,</span>
        <span class="s">&quot;title&quot;</span><span class="p">:</span> <span class="s">&quot;test&quot;</span><span class="p">,</span>
        <span class="s">&quot;total_quantity&quot;</span><span class="p">:</span> <span class="s">&quot;100&quot;</span><span class="p">,</span>
        <span class="s">&quot;vote_count&quot;</span><span class="p">:</span> <span class="s">&quot;0&quot;</span><span class="p">,</span>
        <span class="s">&quot;vote_sum&quot;</span><span class="p">:</span> <span class="s">&quot;0&quot;</span>
    <span class="p">},</span>
    <span class="s">&quot;status_code&quot;</span><span class="p">:</span> <span class="mi">200</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Sample JSON response (offer type <strong>Limited</strong>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>
    <span class="s">&quot;company&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">&quot;address&quot;</span><span class="p">:</span> <span class="s">&quot;οδός Ρόδων 45&quot;</span><span class="p">,</span>
        <span class="s">&quot;afm&quot;</span><span class="p">:</span> <span class="s">&quot;011111111&quot;</span><span class="p">,</span>
        <span class="s">&quot;created&quot;</span><span class="p">:</span> <span class="s">&quot;2012-04-17 09:24:38&quot;</span><span class="p">,</span>
        <span class="s">&quot;fax&quot;</span><span class="p">:</span> <span class="s">&quot;2102345676&quot;</span><span class="p">,</span>
        <span class="s">&quot;id&quot;</span><span class="p">:</span> <span class="s">&quot;4&quot;</span><span class="p">,</span>
        <span class="s">&quot;image_count&quot;</span><span class="p">:</span> <span class="s">&quot;0&quot;</span><span class="p">,</span>
        <span class="s">&quot;is_enabled&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
        <span class="s">&quot;latitude&quot;</span><span class="p">:</span> <span class="s">&quot;37.94471&quot;</span><span class="p">,</span>
        <span class="s">&quot;longitude&quot;</span><span class="p">:</span> <span class="s">&quot;23.76706&quot;</span><span class="p">,</span>
        <span class="s">&quot;modified&quot;</span><span class="p">:</span> <span class="s">&quot;2012-04-17 09:24:38&quot;</span><span class="p">,</span>
        <span class="s">&quot;municipality_id&quot;</span><span class="p">:</span> <span class="s">&quot;144&quot;</span><span class="p">,</span>
        <span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="s">&quot;Pizza Fan&quot;</span><span class="p">,</span>
        <span class="s">&quot;phone&quot;</span><span class="p">:</span> <span class="s">&quot;2108112000&quot;</span><span class="p">,</span>
        <span class="s">&quot;postalcode&quot;</span><span class="p">:</span> <span class="s">&quot;11122&quot;</span><span class="p">,</span>
        <span class="s">&quot;service_type&quot;</span><span class="p">:</span> <span class="s">&quot;Υπηρεσίες&quot;</span><span class="p">,</span>
        <span class="s">&quot;user_id&quot;</span><span class="p">:</span> <span class="s">&quot;9&quot;</span>
    <span class="p">},</span>
    <span class="s">&quot;offer&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">&quot;autoend&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s">&quot;autostart&quot;</span><span class="p">:</span> <span class="s">&quot;2012-07-14 18:00:00&quot;</span><span class="p">,</span>
        <span class="s">&quot;company_id&quot;</span><span class="p">:</span> <span class="s">&quot;4&quot;</span><span class="p">,</span>
        <span class="s">&quot;coupon_count&quot;</span><span class="p">:</span> <span class="s">&quot;0&quot;</span><span class="p">,</span>
        <span class="s">&quot;coupon_terms&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s">&quot;created&quot;</span><span class="p">:</span> <span class="s">&quot;2012-04-17 12:49:56&quot;</span><span class="p">,</span>
        <span class="s">&quot;description&quot;</span><span class="p">:</span> <span class="s">&quot;40% για τους φοιτητές.&quot;</span><span class="p">,</span>
        <span class="s">&quot;ended&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s">&quot;id&quot;</span><span class="p">:</span> <span class="s">&quot;17&quot;</span><span class="p">,</span>
        <span class="s">&quot;image_count&quot;</span><span class="p">:</span> <span class="s">&quot;0&quot;</span><span class="p">,</span>
        <span class="s">&quot;is_spam&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
        <span class="s">&quot;max_per_student&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s">&quot;modified&quot;</span><span class="p">:</span> <span class="s">&quot;2012-04-17 12:49:56&quot;</span><span class="p">,</span>
        <span class="s">&quot;offer_category&quot;</span><span class="p">:</span> <span class="s">&quot;Φαγητό&quot;</span><span class="p">,</span>
        <span class="s">&quot;offer_hours&quot;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s">&quot;offer_state&quot;</span><span class="p">:</span> <span class="s">&quot;active&quot;</span><span class="p">,</span>
        <span class="s">&quot;offer_type&quot;</span><span class="p">:</span> <span class="s">&quot;limited&quot;</span><span class="p">,</span>
        <span class="s">&quot;started&quot;</span><span class="p">:</span> <span class="s">&quot;2012-01-01 00:00:00&quot;</span><span class="p">,</span>
        <span class="s">&quot;tags&quot;</span><span class="p">:</span> <span class="s">&quot;pizza fan πίτσα&quot;</span><span class="p">,</span>
        <span class="s">&quot;student_vote&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s">&quot;vote_type&quot;</span><span class="p">:</span> <span class="mi">0</span>
        <span class="p">},</span>
        <span class="s">&quot;title&quot;</span><span class="p">:</span> <span class="s">&quot;Pizza Fan 40 τοις εκατό&quot;</span><span class="p">,</span>
        <span class="s">&quot;total_quantity&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s">&quot;vote_count&quot;</span><span class="p">:</span> <span class="s">&quot;0&quot;</span><span class="p">,</span>
        <span class="s">&quot;vote_sum&quot;</span><span class="p">:</span> <span class="s">&quot;0&quot;</span>
    <span class="p">},</span>
    <span class="s">&quot;status_code&quot;</span><span class="p">:</span> <span class="mi">200</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Οι τιμές των πεδίων <cite>vote_type</cite> συνοψίζονται στην ενότητα  <a class="reference internal" href="#offer-vote">Offer Vote</a> .</p>
</div>
</div>
<div class="section" id="coupon-view">
<h3>Coupon View<a class="headerlink" href="#coupon-view" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="9%" />
<col width="40%" />
<col width="51%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Method</th>
<th class="head">Rest URI</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>GET</td>
<td>url/<strong>coupon</strong>/<em>{couponId}</em></td>
<td>Get coupon info with id <em>couponId</em></td>
</tr>
</tbody>
</table>
<p>Sample JSON request</p>
<div class="highlight-python"><pre>$ curl -X GET http://coupons.edu.teiath.gr/api/coupon/1 \
    -H &quot;Accept: application/json&quot; \
    -b /tmp/cookie</pre>
</div>
<p>Sample JSON response</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>
    <span class="s">&quot;company&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">&quot;address&quot;</span><span class="p">:</span> <span class="s">&quot;οδός Μαστραχά 88&quot;</span><span class="p">,</span>
        <span class="s">&quot;afm&quot;</span><span class="p">:</span> <span class="s">&quot;000000012&quot;</span><span class="p">,</span>
        <span class="s">&quot;fax&quot;</span><span class="p">:</span> <span class="s">&quot;2107654321&quot;</span><span class="p">,</span>
        <span class="s">&quot;id&quot;</span><span class="p">:</span> <span class="s">&quot;101&quot;</span><span class="p">,</span>
        <span class="s">&quot;latitude&quot;</span><span class="p">:</span> <span class="s">&quot;38.08804&quot;</span><span class="p">,</span>
        <span class="s">&quot;longitude&quot;</span><span class="p">:</span> <span class="s">&quot;23.6598&quot;</span><span class="p">,</span>
        <span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="s">&quot;OPPENHEIM CAPITAL LTD&quot;</span><span class="p">,</span>
        <span class="s">&quot;phone&quot;</span><span class="p">:</span> <span class="s">&quot;2101234567&quot;</span><span class="p">,</span>
        <span class="s">&quot;postalcode&quot;</span><span class="p">:</span> <span class="s">&quot;12345&quot;</span><span class="p">,</span>
        <span class="s">&quot;service_type&quot;</span><span class="p">:</span> <span class="s">&quot;Υπηρεσίες&quot;</span>
    <span class="p">},</span>
    <span class="s">&quot;coupon&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">&quot;created&quot;</span><span class="p">:</span> <span class="s">&quot;2012-06-14 10:06:50&quot;</span><span class="p">,</span>
        <span class="s">&quot;id&quot;</span><span class="p">:</span> <span class="s">&quot;1&quot;</span><span class="p">,</span>
        <span class="s">&quot;offer_id&quot;</span><span class="p">:</span> <span class="s">&quot;9&quot;</span><span class="p">,</span>
        <span class="s">&quot;serial_number&quot;</span><span class="p">:</span> <span class="s">&quot;caccb026-2f2d-4d43-b70f-38e6d931cbd7&quot;</span><span class="p">,</span>
        <span class="s">&quot;reinserted&quot;</span><span class="p">:</span> <span class="s">&quot;1&quot;</span><span class="p">,</span>
        <span class="s">&quot;student_id&quot;</span><span class="p">:</span> <span class="s">&quot;4&quot;</span>
    <span class="p">},</span>
    <span class="s">&quot;offer&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">&quot;autoend&quot;</span><span class="p">:</span> <span class="s">&quot;2077-01-01 00:00:00&quot;</span><span class="p">,</span>
        <span class="s">&quot;autostart&quot;</span><span class="p">:</span> <span class="s">&quot;0000-00-00 00:00:00&quot;</span><span class="p">,</span>
        <span class="s">&quot;company_id&quot;</span><span class="p">:</span> <span class="s">&quot;101&quot;</span><span class="p">,</span>
        <span class="s">&quot;coupon_count&quot;</span><span class="p">:</span> <span class="s">&quot;1&quot;</span><span class="p">,</span>
        <span class="s">&quot;coupon_terms&quot;</span><span class="p">:</span> <span class="s">&quot;Όροι εξαργύρωσης κουπονιού&quot;</span><span class="p">,</span>
        <span class="s">&quot;description&quot;</span><span class="p">:</span> <span class="s">&quot;Περιγραφή προσφοράς 9&quot;</span><span class="p">,</span>
        <span class="s">&quot;ended&quot;</span><span class="p">:</span> <span class="s">&quot;0000-00-00 00:00:00&quot;</span><span class="p">,</span>
        <span class="s">&quot;id&quot;</span><span class="p">:</span> <span class="s">&quot;9&quot;</span><span class="p">,</span>
        <span class="s">&quot;image_count&quot;</span><span class="p">:</span> <span class="s">&quot;0&quot;</span><span class="p">,</span>
        <span class="s">&quot;is_spam&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
        <span class="s">&quot;max_per_student&quot;</span><span class="p">:</span> <span class="s">&quot;5&quot;</span><span class="p">,</span>
        <span class="s">&quot;offer_category_id&quot;</span><span class="p">:</span> <span class="s">&quot;5&quot;</span><span class="p">,</span>
        <span class="s">&quot;offer_state_id&quot;</span><span class="p">:</span> <span class="s">&quot;2&quot;</span><span class="p">,</span>
        <span class="s">&quot;offer_type_id&quot;</span><span class="p">:</span> <span class="s">&quot;2&quot;</span><span class="p">,</span>
        <span class="s">&quot;started&quot;</span><span class="p">:</span> <span class="s">&quot;2012-01-01 00:00:00&quot;</span><span class="p">,</span>
        <span class="s">&quot;tags&quot;</span><span class="p">:</span> <span class="s">&quot;λήμμα-31 λήμμα-1 λήμμα-4&quot;</span><span class="p">,</span>
        <span class="s">&quot;student_vote&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s">&quot;vote_type&quot;</span><span class="p">:</span> <span class="mi">0</span>
        <span class="p">},</span>
        <span class="s">&quot;title&quot;</span><span class="p">:</span> <span class="s">&quot;Προσφορά 9&quot;</span><span class="p">,</span>
        <span class="s">&quot;total_quantity&quot;</span><span class="p">:</span> <span class="s">&quot;60&quot;</span><span class="p">,</span>
        <span class="s">&quot;vote_count&quot;</span><span class="p">:</span> <span class="s">&quot;73&quot;</span><span class="p">,</span>
        <span class="s">&quot;vote_sum&quot;</span><span class="p">:</span> <span class="s">&quot;-20&quot;</span>
    <span class="p">},</span>
    <span class="s">&quot;status_code&quot;</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
    <span class="s">&quot;student&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">&quot;firstname&quot;</span><span class="p">:</span> <span class="s">&quot;latsas&quot;</span><span class="p">,</span>
        <span class="s">&quot;id&quot;</span><span class="p">:</span> <span class="s">&quot;4&quot;</span><span class="p">,</span>
        <span class="s">&quot;lastname&quot;</span><span class="p">:</span> <span class="s">&quot;latsas&quot;</span><span class="p">,</span>
        <span class="s">&quot;user_id&quot;</span><span class="p">:</span> <span class="s">&quot;151&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Sample XML response</p>
<div class="highlight-python"><pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;response status_code=&quot;200&quot;&gt;
  &lt;offer id=&quot;9&quot;&gt;
    &lt;title&gt;Προσφορά 9&lt;/title&gt;
    &lt;description&gt;Περιγραφή προσφοράς Προσφορά 9&lt;/description&gt;
    &lt;started&gt;2012-01-01T00:00:00&lt;/started&gt;
    &lt;ended&gt;1970-01-01T02:00:00&lt;/ended&gt;
    &lt;autostart&gt;1970-01-01T02:00:00&lt;/autostart&gt;
    &lt;autoend&gt;1970-01-01T02:00:00&lt;/autoend&gt;
    &lt;coupon_terms&gt;Όροι εξαργύρωσης κουπονιού&lt;/coupon_terms&gt;
    &lt;total_quantity&gt;60&lt;/total_quantity&gt;
    &lt;coupon_count&gt;1&lt;/coupon_count&gt;
    &lt;max_per_student&gt;5&lt;/max_per_student&gt;
    &lt;tags&gt;λήμμα-31 λήμμα-1 λήμμα-4 &lt;/tags&gt;
    &lt;offer_category_id&gt;5&lt;/offer_category_id&gt;
    &lt;offer_type_id&gt;2&lt;/offer_type_id&gt;
    &lt;company_id&gt;101&lt;/company_id&gt;
    &lt;image_count&gt;0&lt;/image_count&gt;
    &lt;offer_state_id&gt;2&lt;/offer_state_id&gt;
    &lt;is_spam&gt;0&lt;/is_spam&gt;
    &lt;vote_count&gt;73&lt;/vote_count&gt;
    &lt;vote_sum&gt;-20&lt;/vote_sum&gt;
    &lt;student_vote&gt;
        &lt;vote_type&gt;0&lt;/vote_type&gt;
    &lt;/student_vote&gt;
  &lt;/offer&gt;
  &lt;coupon id=&quot;1&quot;&gt;
    &lt;serial_number&gt;caccb026-2f2d-4d43-b70f-38e6d931cbd7&lt;/serial_number&gt;
    &lt;created&gt;2012-06-14T10:06:50&lt;/created&gt;
    &lt;offer_id&gt;9&lt;/offer_id&gt;
    &lt;student_id&gt;4&lt;/student_id&gt;
    &lt;reinserted&gt;1&lt;/reinserted&gt;
  &lt;/coupon&gt;
  &lt;student id=&quot;4&quot;&gt;
    &lt;firstname&gt;latsas&lt;/firstname&gt;
    &lt;lastname&gt;latsas&lt;/lastname&gt;
    &lt;user_id&gt;151&lt;/user_id&gt;
  &lt;/student&gt;
  &lt;company id=&quot;101&quot;&gt;
    &lt;name&gt;OPPENHEIM CAPITAL LTD&lt;/name&gt;
    &lt;address&gt;οδός Μαστραχά 88&lt;/address&gt;
    &lt;postalcode&gt;12345&lt;/postalcode&gt;
    &lt;phone&gt;2101234567&lt;/phone&gt;
    &lt;fax&gt;2107654321&lt;/fax&gt;
    &lt;service_type&gt;Υπηρεσίες&lt;/service_type&gt;
    &lt;afm&gt;000000012&lt;/afm&gt;
    &lt;latitude&gt;38.08804&lt;/latitude&gt;
    &lt;longitude&gt;23.6598&lt;/longitude&gt;
  &lt;/company&gt;
&lt;/response&gt;</pre>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>Για την ενέργεια απαιτείται αυθεντικοποίηση.</li>
<li>Η ενέργεια είναι διαθέσιμη μόνο σε σπουδαστές</li>
</ul>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Εάν το κουπόνι δεν υπάρχει επιστρέφεται HTTP 404.</p>
</div>
<p>Sample not found response</p>
<div class="highlight-python"><pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;response status_code=&quot;404&quot;&gt;&lt;message&gt;Not Found&lt;/message&gt;&lt;/response&gt;</pre>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Το πεδίο <cite>reinserted</cite> υποδυκνείει εάν το κουπόνι έχει αποδεσμευθεί ή όχι.
Η τιμή <cite>1</cite> δείχνει αποδεσμευμένο κουπόνι και η τιμή <cite>0</cite> ότι το κουπόνι είναι σε
ισχύ και ο χρήστης είναι ακόμα ο κάτοχος του κουπονιού. Δες: <a class="reference internal" href="#coupon-release-reinsert">Coupon release (reinsert)</a> .</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Οι τιμές των πεδίων <cite>vote_type</cite> συνοψίζονται στην ενότητα  <a class="reference internal" href="#offer-vote">Offer Vote</a> .</p>
</div>
</div>
<div class="section" id="coupon-index">
<h3>Coupon Index<a class="headerlink" href="#coupon-index" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="44%" />
<col width="46%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Method</th>
<th class="head">Rest URI</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>GET</td>
<td>url/<strong>coupons</strong></td>
<td>Get a list of user&#8217;s coupons</td>
</tr>
</tbody>
</table>
<p>Sample JSON request</p>
<div class="highlight-python"><pre>$ curl -s -X GET http://coupons.edu.teiath.gr/api/coupons \
    -H &quot;Accept: application/json&quot; \
    -b /tmp/cookie</pre>
</div>
<p>Sample JSON response</p>
<div class="highlight-python"><pre>{
    &quot;coupons&quot;: [
        {
            &quot;coupon&quot;: {
                &quot;created&quot;: &quot;2012-06-14 14:20:36&quot;,
                &quot;id&quot;: &quot;3&quot;,
                &quot;serial_number&quot;: &quot;0e9e3ae1-95a5-4e90-bd1a-7d5dd2cfd106&quot;,
                &quot;reinserted&quot;: &quot;0&quot;
            },
            &quot;offer&quot;: {
                &quot;id&quot;: 100&quot;,
                &quot;company_id&quot;: &quot;109&quot;,
                &quot;coupon_terms&quot;: &quot;Όροι εξαργύρωσης κουπονιού&quot;,
                &quot;description&quot;: &quot;Περιγραφή προσφοράς Προσφορά 39&quot;,
                &quot;offer_category_id&quot;: &quot;1&quot;,
                &quot;offer_type_id&quot;: &quot;2&quot;,
                &quot;title&quot;: &quot;Προσφορά 39&quot;,
                &quot;vote_count&quot;: &quot;62&quot;,
                &quot;vote_sum&quot;: &quot;7&quot;,
                &quot;is_spam&quot;: &quot;0&quot;,
                &quot;offer_state_id&quot;: &quot;3&quot;,
                &quot;student_vote&quot;: {
                    &quot;vote_type&quot;: null
                },
            }
        },
        {
            &quot;coupon&quot;: {
                &quot;created&quot;: &quot;2012-06-14 14:20:30&quot;,
                &quot;id&quot;: &quot;2&quot;,
                &quot;serial_number&quot;: &quot;b5606315-b73a-49bf-ad91-f4a71f4642f9&quot;
            },
            &quot;offer&quot;: {
                &quot;id&quot;: 101&quot;,
                &quot;company_id&quot;: &quot;122&quot;,
                &quot;coupon_terms&quot;: &quot;Όροι εξαργύρωσης κουπονιού&quot;,
                &quot;description&quot;: &quot;Περιγραφή προσφοράς Προσφορά 98&quot;,
                &quot;offer_category_id&quot;: &quot;8&quot;,
                &quot;offer_type_id&quot;: &quot;2&quot;,
                &quot;title&quot;: &quot;Προσφορά  98&quot;,
                &quot;vote_count&quot;: &quot;82&quot;,
                &quot;vote_sum&quot;: &quot;-55&quot;,
                &quot;is_spam&quot;: &quot;1&quot;,
                &quot;offer_state_id&quot;: &quot;3&quot;,
                &quot;student_vote&quot;: {
                    &quot;vote_type&quot;: null
                },
            }
        },
        {
            &quot;coupon&quot;: {
                &quot;created&quot;: &quot;2012-06-14 10:06:50&quot;,
                &quot;id&quot;: &quot;1&quot;,
                &quot;serial_number&quot;: &quot;caccb026-2f2d-4d43-b70f-38e6d931cbd7&quot;
            },
            &quot;offer&quot;: {
                &quot;id&quot;: 102&quot;,
                &quot;company_id&quot;: &quot;101&quot;,
                &quot;coupon_terms&quot;: &quot;Όροι εξαργύρωσης κουπονιού&quot;,
                &quot;description&quot;: &quot;Περιγραφή προσφοράς Προσφορά 9&quot;,
                &quot;offer_category_id&quot;: &quot;5&quot;,
                &quot;offer_type_id&quot;: &quot;2&quot;,
                &quot;title&quot;: &quot;Προσφορά 9&quot;,
                &quot;vote_count&quot;: &quot;73&quot;,
                &quot;vote_sum&quot;: &quot;-20&quot;,
                &quot;is_spam&quot;: &quot;1&quot;,
                &quot;offer_state_id&quot;: &quot;3&quot;,
                &quot;student_vote&quot;: {
                    &quot;vote_type&quot;: null
                },
            }
        }
    ],
    &quot;status_code&quot;: 200
}</pre>
</div>
<p>Sample XML request</p>
<div class="highlight-python"><pre>$ curl -s -X GET http://coupons.edu.teiath.gr/api/coupons \
    -H &quot;Accept: application/xml&quot; \
    -b /tmp/cookie</pre>
</div>
<p>Sample XML response:</p>
<div class="highlight-python"><pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;response status_code=&quot;200&quot;&gt;
  &lt;coupons&gt;
    &lt;offer id=&quot;101&quot;&gt;
      &lt;title&gt;Προσφορά 39&lt;/title&gt;
      &lt;description&gt;Περιγραφή προσφοράς Προσφορά 39&lt;/description&gt;
      &lt;coupon_terms&gt;Όροι εξαργύρωσης κουπονιού&lt;/coupon_terms&gt;
      &lt;offer_category_id&gt;1&lt;/offer_category_id&gt;
      &lt;offer_type_id&gt;2&lt;/offer_type_id&gt;
      &lt;vote_count&gt;62&lt;/vote_count&gt;
      &lt;is_spam&gt;0&lt;/is_spam&gt;
      &lt;offer_state_id&gt;3&lt;/offer_state_id&gt;
      &lt;vote_sum&gt;7&lt;/vote_sum&gt;
      &lt;company_id&gt;109&lt;/company_id&gt;
      &lt;student_vote&gt;
        &lt;vote_type/&gt;
      &lt;/student_vote&gt;
    &lt;/offer&gt;
    &lt;coupon id=&quot;3&quot;&gt;
      &lt;serial_number&gt;0e9e3ae1-95a5-4e90-bd1a-7d5dd2cfd106&lt;/serial_number&gt;
      &lt;created&gt;2012-06-14T14:20:36&lt;/created&gt;
    &lt;/coupon&gt;
  &lt;/coupons&gt;
  &lt;coupons&gt;
    &lt;offer id=&quot;102&quot;&gt;
      &lt;title&gt;Προσφορά 98&lt;/title&gt;
      &lt;description&gt;Περιγραφή προσφοράς Προσφορά 98&lt;/description&gt;
      &lt;coupon_terms&gt;Όροι εξαργύρωσης κουπονιού&lt;/coupon_terms&gt;
      &lt;offer_category_id&gt;8&lt;/offer_category_id&gt;
      &lt;offer_type_id&gt;2&lt;/offer_type_id&gt;
      &lt;vote_count&gt;82&lt;/vote_count&gt;
      &lt;is_spam&gt;1&lt;/is_spam&gt;
      &lt;offer_state_id&gt;3&lt;/offer_state_id&gt;
      &lt;vote_sum&gt;-55&lt;/vote_sum&gt;
      &lt;company_id&gt;122&lt;/company_id&gt;
      &lt;student_vote&gt;
        &lt;vote_type/&gt;
      &lt;/student_vote&gt;
    &lt;/offer&gt;
    &lt;coupon id=&quot;2&quot;&gt;
      &lt;serial_number&gt;b5606315-b73a-49bf-ad91-f4a71f4642f9&lt;/serial_number&gt;
      &lt;created&gt;2012-06-14T14:20:30&lt;/created&gt;
    &lt;/coupon&gt;
  &lt;/coupons&gt;
  &lt;coupons&gt;
    &lt;offer id=&quot;103&quot;&gt;
      &lt;title&gt;Προσφορά 9&lt;/title&gt;
      &lt;description&gt;Περιγραφή προσφοράς Προσφορά 9&lt;/description&gt;
      &lt;coupon_terms&gt;Όροι εξαργύρωσης κουπονιού&lt;/coupon_terms&gt;
      &lt;offer_category_id&gt;5&lt;/offer_category_id&gt;
      &lt;offer_type_id&gt;2&lt;/offer_type_id&gt;
      &lt;vote_count&gt;73&lt;/vote_count&gt;
      &lt;vote_sum&gt;-20&lt;/vote_sum&gt;
      &lt;company_id&gt;101&lt;/company_id&gt;
      &lt;is_spam&gt;1&lt;/is_spam&gt;
      &lt;offer_state_id&gt;3&lt;/offer_state_id&gt;
      &lt;student_vote&gt;
        &lt;vote_type/&gt;
      &lt;/student_vote&gt;
    &lt;/offer&gt;
    &lt;coupon id=&quot;1&quot;&gt;
      &lt;serial_number&gt;caccb026-2f2d-4d43-b70f-38e6d931cbd7&lt;/serial_number&gt;
      &lt;created&gt;2012-06-14T10:06:50&lt;/created&gt;
    &lt;/coupon&gt;
  &lt;/coupons&gt;
&lt;/response&gt;</pre>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>Για την ενέργεια απαιτείται αυθεντικοποίηση.</li>
<li>Η ενέργεια είναι διαθέσιμη μόνο σε σπουδαστές.</li>
<li>Επιστρέφονται τα κουπόνια του τρέχοντος σπουδαστή που έχει συνδεθεί, δεν απαιτείται κάποιο id.</li>
</ul>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Το πεδίο <cite>reinserted</cite> υποδυκνείει εάν το κουπόνι έχει αποδεσμευθεί ή όχι.
Η τιμή <cite>1</cite> δείχνει αποδεσμευμένο κουπόνι και η τιμή <cite>0</cite> ότι το κουπόνι είναι σε
ισχύ και ο χρήστης είναι ακόμα ο κάτοχος του κουπονιού. Δες: <a class="reference internal" href="#coupon-release-reinsert">Coupon release (reinsert)</a> .</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Οι τιμές των πεδίων <cite>vote_type</cite> συνοψίζονται στην ενότητα  <a class="reference internal" href="#offer-vote">Offer Vote</a> .</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Το πεδίο <cite>is_spam</cite> παίρνει τιμές <cite>1</cite> και <cite>0</cite>.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Το πεδίο <cite>offer_state_id</cite> παίνει τις τιμές:</p>
<ul class="simple">
<li>1 =&gt; Προσφορά DRAFT (δεν έχει ενεργοποιηθεί ακόμα από τον επιχειρηματία).</li>
<li>2 =&gt; Ενεργή προσφορά.</li>
<li>3 =&gt; Προσφορά η οποία έχει λήξει.</li>
</ul>
<p class="last">Οι παραπάνω τιμές αντιστοιχούν στις <a class="reference external" href="http://git.edu.teiath.gr/coupons.git/tree/app/Config/configuration.php.default">default τιμές</a> της εφαρμογής.</p>
</div>
</div>
<div class="section" id="grab-coupon">
<h3>Grab Coupon<a class="headerlink" href="#grab-coupon" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="8%" />
<col width="38%" />
<col width="54%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Method</th>
<th class="head">Rest URI</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>POST</td>
<td>url/<strong>coupon</strong>/<em>{offerId}</em></td>
<td>Get coupon for offer with id <em>offerId</em></td>
</tr>
</tbody>
</table>
<p>Sample JSON request</p>
<div class="highlight-python"><pre>$ curl -X POST http://url/coupon/1 \
    -H &quot;Accept: application/json&quot; \
    -b /tmp/cookie</pre>
</div>
<p>Sample JSON response:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>
    <span class="s">&quot;id&quot;</span><span class="p">:</span> <span class="s">&quot;9&quot;</span><span class="p">,</span>
    <span class="s">&quot;message&quot;</span><span class="p">:</span> <span class="s">&quot;Το κουπόνι δεσμεύτηκε επιτυχώς&quot;</span><span class="p">,</span>
    <span class="s">&quot;serial_number&quot;</span><span class="p">:</span> <span class="s">&quot;637d31b5-0760-4390-b164-0c2978f845d9&quot;</span><span class="p">,</span>
    <span class="s">&quot;status_code&quot;</span><span class="p">:</span> <span class="mi">200</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Sample XML request</p>
<div class="highlight-python"><pre>$ curl -X POST http://url/coupon/1 \
    -H &quot;Accept: application/xml&quot; \
    -b /tmp/cookie</pre>
</div>
<p>Sample XML response:</p>
<div class="highlight-python"><pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;response status_code=&quot;200&quot;&gt;
  &lt;message&gt;Το κουπόνι δεσμεύτηκε επιτυχώς&lt;/message&gt;
  &lt;id&gt;10&lt;/id&gt;
  &lt;serial_number&gt;d13f9aec-8d5c-4d52-90ef-794421f1b515&lt;/serial_number&gt;
&lt;/response&gt;</pre>
</div>
<p>Όταν ο σπουδαστής δεσμεύσει τον μέγιστο αριθμό κουπονιών επιστρέφεται <strong>HTTP 400</strong>.</p>
<p>XML:</p>
<div class="highlight-python"><pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;response status_code=&quot;400&quot;&gt;
  &lt;message&gt;Έχετε δεσμεύσει τον μέγιστο αριθμό κουπονιών για αυτήν την προσφορά.&lt;/message&gt;
&lt;/response&gt;</pre>
</div>
<p>JSON:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>
    <span class="s">&quot;message&quot;</span><span class="p">:</span> <span class="s">&quot;Έχετε δεσμεύσει τον μέγιστο αριθμό κουπονιών για αυτήν την προσφορά.&quot;</span><span class="p">,</span>
    <span class="s">&quot;status_code&quot;</span><span class="p">:</span> <span class="mi">400</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>Για την ενέργεια απαιτείται αυθεντικοποίηση.</li>
<li>Η ενέργεια είναι διαθέσιμη μόνο σε σπουδαστές.</li>
</ul>
</div>
<p>Όταν ο σπουδαστής δεν έχει αυθεντικοποιηθεί επιστρέφεται <strong>HTTP 403</strong>.</p>
<p>XML:</p>
<div class="highlight-python"><pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;response status_code=&quot;403&quot;&gt;
  &lt;message&gt;Forbidden&lt;/message&gt;
&lt;/response&gt;</pre>
</div>
<p>JSON:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>
    <span class="s">&quot;message&quot;</span><span class="p">:</span> <span class="s">&quot;Forbidden&quot;</span><span class="p">,</span>
    <span class="s">&quot;status_code&quot;</span><span class="p">:</span> <span class="s">&quot;403&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Όταν ο σπουδαστής δεσμεύσει τον μέγιστο αριθμό κουπονιών επιστρέφεται <strong>HTTP 400</strong>.</p>
</div>
<div class="section" id="coupon-release-reinsert">
<h3>Coupon release (reinsert)<a class="headerlink" href="#coupon-release-reinsert" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="6%" />
<col width="57%" />
<col width="37%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Method</th>
<th class="head">Rest URI</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>GET</td>
<td>url/<strong>coupons/reinsert</strong>/<em>{couponId}</em></td>
<td>Release coupon with id: <em>{couponId}</em></td>
</tr>
</tbody>
</table>
<p>Αποδεσμεύει το κουπόνι. Ο χρήστης παύει να είναι ο κάτοχος του κουπονιού και
η ισχύς του κουπονιού ακυρώνεται. Απαιτείται αυθεντικοποίηση.</p>
<p>Sample JSON request</p>
<div class="highlight-python"><pre>$ curl -X GET http://coupons.edu.teiath.gr/api/coupons/reinsert/10
    -H &quot;Accept: application/json&quot; \
    -b /tmp/cookie</pre>
</div>
<p>Sample JSON response</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>
    <span class="s">&quot;id&quot;</span><span class="p">:</span> <span class="s">&quot;10&quot;</span><span class="p">,</span>
    <span class="s">&quot;message&quot;</span><span class="p">:</span> <span class="s">&quot;Το κουπόνι f617a0bf-e628-4823-92b7-1954286d934d αποδεσμεύτηκε επιτυχώς&quot;</span><span class="p">,</span>
    <span class="s">&quot;serial_number&quot;</span><span class="p">:</span> <span class="s">&quot;f617a0bf-e628-4823-92b7-1954286d934d&quot;</span><span class="p">,</span>
    <span class="s">&quot;status_code&quot;</span><span class="p">:</span> <span class="mi">200</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="set-coordinates">
<h3>Set coordinates<a class="headerlink" href="#set-coordinates" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="6%" />
<col width="55%" />
<col width="39%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Method</th>
<th class="head">Rest URI</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>GET</td>
<td>url/<strong>users/coordinates</strong>/lat:{latitude}/lng:{longitude}</td>
<td>Set location to {latitude}, {longitude}</td>
</tr>
</tbody>
</table>
<p>Sample JSON request</p>
<div class="highlight-python"><pre>$ curl -X GET http://url/users/coordinates/lat:55.496858/lng:9.747620 \
    -H &quot;Accept: application/json&quot; \
    -b /tmp/cookie</pre>
</div>
<p>Sample JSON response:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>
    <span class="s">&quot;message&quot;</span><span class="p">:</span> <span class="s">&quot;Οι συντεταγμένες αποθηκεύτηκαν (23.312345,87.19325)&quot;</span><span class="p">,</span>
    <span class="s">&quot;status_code&quot;</span><span class="p">:</span> <span class="mi">200</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Sample XML request</p>
<div class="highlight-python"><pre>$ curl -X GET http://url/users/coordinates/lat:55.496858/lng:9.747620 \
    -H &quot;Accept: application/xml&quot; \
    -b /tmp/cookie</pre>
</div>
<p>Sample XML response:</p>
<div class="highlight-python"><pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;response status_code=&quot;200&quot;&gt;
    &lt;message&gt;Οι συντεταγμένες αποθηκεύτηκαν (23.312345,87.19325)&lt;/message&gt;
&lt;/response&gt;</pre>
</div>
</div>
<div class="section" id="set-search-radius">
<h3>Set search radius<a class="headerlink" href="#set-search-radius" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="8%" />
<col width="43%" />
<col width="49%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Method</th>
<th class="head">Rest URI</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>GET</td>
<td>url/<strong>users/radius</strong>/{radius}</td>
<td>Set search radius to {radius} (in Km)</td>
</tr>
</tbody>
</table>
<p>Valid radius values:</p>
<table border="1" class="docutils">
<colgroup>
<col width="100%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">{radius} in Km</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1</td>
</tr>
<tr class="row-odd"><td>5</td>
</tr>
<tr class="row-even"><td>10</td>
</tr>
</tbody>
</table>
<p>Sample JSON request</p>
<div class="highlight-python"><pre>$ curl -X GET http://coupons/edu.teiath.gr/api/users/radius/5 \
    -H &quot;Accept: application/json&quot; \
    -b /tmp/cookie</pre>
</div>
<p>Sample JSON response:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>
    <span class="s">&quot;status_code&quot;</span><span class="p">:</span><span class="mi">200</span><span class="p">,</span>
    <span class="s">&quot;message&quot;</span><span class="p">:</span><span class="s">&quot;Η ακτίνα αναζήτησης αποθηκεύτηκε με επιτυχία.&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Sample XML request</p>
<div class="highlight-python"><pre>$ curl -X GET http://coupons/edu.teiath.gr/api/users/radius/5 \
    -H &quot;Accept: application/xml&quot; \
    -b /tmp/cookie</pre>
</div>
<p>Sample XML response:</p>
<div class="highlight-python"><pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;response status_code=&quot;200&quot;&gt;
    &lt;message&gt;Η ακτίνα αναζήτησης αποθηκεύτηκε με επιτυχία.&lt;/message&gt;
&lt;/response&gt;</pre>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Σε περίπτωση μη έγκυρου αριθμού ακτίνας, χρησιμοποιείται η μεγαλύτερη.</p>
</div>
</div>
<div class="section" id="offer-vote">
<h3>Offer Vote<a class="headerlink" href="#offer-vote" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="7%" />
<col width="43%" />
<col width="49%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Method</th>
<th class="head">Rest URI</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>GET</td>
<td>url/<strong>vote/vote_up</strong>/<em>{offerId}</em></td>
<td>Upvote the offer with id <em>{offerId}</em></td>
</tr>
<tr class="row-odd"><td>GET</td>
<td>url/<strong>vote/vote_down</strong>/<em>{offerId}</em></td>
<td>Downvote the offer with id <em>{offerId}</em></td>
</tr>
<tr class="row-even"><td>GET</td>
<td>url/<strong>vote/vote_cancel</strong>/<em>{offerId}</em></td>
<td>Cancel vote for offer with id <em>{offerId}</em></td>
</tr>
</tbody>
</table>
<p>Sample JSON response for upvote:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>
    <span class="s">&quot;status_code&quot;</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
    <span class="s">&quot;vote&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">&quot;offer_id&quot;</span><span class="p">:</span> <span class="s">&quot;1&quot;</span><span class="p">,</span>
        <span class="s">&quot;vote_type&quot;</span><span class="p">:</span> <span class="mi">1</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Sample XML response for upvote:</p>
<div class="highlight-python"><pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;response status_code=&quot;200&quot;&gt;
  &lt;vote&gt;
    &lt;offer_id&gt;1&lt;/offer_id&gt;
    &lt;vote_type&gt;1&lt;/vote_type&gt;
  &lt;/vote&gt;
&lt;/response&gt;</pre>
</div>
<p>Vote type table:</p>
<table border="1" class="docutils">
<colgroup>
<col width="25%" />
<col width="75%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">vote type</th>
<th class="head">interpretation</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>1</strong></td>
<td>upvote (+1 at web)</td>
</tr>
<tr class="row-odd"><td><strong>0</strong></td>
<td>downvote (-1 at web)</td>
</tr>
<tr class="row-even"><td><strong>null</strong></td>
<td>student hasn&#8217;t voted yet</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="user-votes-listing">
<h3>User Votes (listing)<a class="headerlink" href="#user-votes-listing" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="8%" />
<col width="51%" />
<col width="41%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Method</th>
<th class="head">Rest URI</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>GET</td>
<td>url/<strong>votes</strong></td>
<td>Return logged-in user&#8217;s votes</td>
</tr>
</tbody>
</table>
<p>Επιστρέφει όλες τις προσφορές που έχει ψηφίσει ο συνδεδεμένος σπουδαστής.
Η ψήφος του χρήστη για μια συγκεκριμένη προσφορά επιστρέφεται στο πεδίο <cite>vote</cite>
το οποίο μπορεί να περιέχει <cite>1</cite> (θετική ψήφος) ή <cite>0</cite> (αρνητική ψήφος).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Απαιτείται αυθεντικοποίηση.</p>
</div>
<p>Sample JSON request:</p>
<div class="highlight-python"><pre>$ curl -s -X GET &#x27;http://coupons.edu.teiath.gr/api/votes/&#x27; \
    -H &quot;Accept: application/json&quot; -b /tmp/cookie</pre>
</div>
<p>Sample JSON response:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>
    <span class="s">&quot;status_code&quot;</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
    <span class="s">&quot;votes&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s">&quot;offer&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s">&quot;id&quot;</span><span class="p">:</span> <span class="s">&quot;48&quot;</span><span class="p">,</span>
                <span class="s">&quot;offer_type_id&quot;</span><span class="p">:</span> <span class="s">&quot;2&quot;</span><span class="p">,</span>
                <span class="s">&quot;title&quot;</span><span class="p">:</span> <span class="s">&quot;Προσφορά 48&quot;</span><span class="p">,</span>
                <span class="s">&quot;vote_count&quot;</span><span class="p">:</span> <span class="s">&quot;81&quot;</span><span class="p">,</span>
                <span class="s">&quot;vote_minus&quot;</span><span class="p">:</span> <span class="s">&quot;44&quot;</span><span class="p">,</span>
                <span class="s">&quot;vote_plus&quot;</span><span class="p">:</span> <span class="s">&quot;37&quot;</span><span class="p">,</span>
                <span class="s">&quot;vote_sum&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">7</span>
            <span class="p">},</span>
            <span class="s">&quot;vote&quot;</span><span class="p">:</span> <span class="mi">1</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s">&quot;offer&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s">&quot;id&quot;</span><span class="p">:</span> <span class="s">&quot;264&quot;</span><span class="p">,</span>
                <span class="s">&quot;offer_type_id&quot;</span><span class="p">:</span> <span class="s">&quot;2&quot;</span><span class="p">,</span>
                <span class="s">&quot;title&quot;</span><span class="p">:</span> <span class="s">&quot;Προσφορά 264&quot;</span><span class="p">,</span>
                <span class="s">&quot;vote_count&quot;</span><span class="p">:</span> <span class="s">&quot;91&quot;</span><span class="p">,</span>
                <span class="s">&quot;vote_minus&quot;</span><span class="p">:</span> <span class="s">&quot;54&quot;</span><span class="p">,</span>
                <span class="s">&quot;vote_plus&quot;</span><span class="p">:</span> <span class="s">&quot;37&quot;</span><span class="p">,</span>
                <span class="s">&quot;vote_sum&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">17</span>
            <span class="p">},</span>
            <span class="s">&quot;vote&quot;</span><span class="p">:</span> <span class="mi">1</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Sample XML request:</p>
<div class="highlight-python"><pre>$ curl -s -X GET &#x27;http://coupons.edu.teiath.gr/api/votes/&#x27; \
    -H &quot;Accept: application/xml&quot; -b /tmp/cookie</pre>
</div>
<p>Sample XML response:</p>
<div class="highlight-python"><pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;response status_code=&quot;200&quot;&gt;
  &lt;votes&gt;
    &lt;vote_info&gt;
      &lt;vote&gt;1&lt;/vote&gt;
      &lt;offer&gt;
        &lt;id&gt;48&lt;/id&gt;
        &lt;offer_type_id&gt;2&lt;/offer_type_id&gt;
        &lt;title&gt;Προσφορά 48&lt;/title&gt;
        &lt;vote_count&gt;81&lt;/vote_count&gt;
        &lt;vote_plus&gt;37&lt;/vote_plus&gt;
        &lt;vote_minus&gt;44&lt;/vote_minus&gt;
        &lt;vote_sum&gt;-7&lt;/vote_sum&gt;
      &lt;/offer&gt;
    &lt;/vote_info&gt;
    &lt;vote_info&gt;
      &lt;vote&gt;1&lt;/vote&gt;
      &lt;offer&gt;
        &lt;id&gt;264&lt;/id&gt;
        &lt;offer_type_id&gt;2&lt;/offer_type_id&gt;
        &lt;title&gt;Προσφορά 264&lt;/title&gt;
        &lt;vote_count&gt;91&lt;/vote_count&gt;
        &lt;vote_plus&gt;37&lt;/vote_plus&gt;
        &lt;vote_minus&gt;54&lt;/vote_minus&gt;
        &lt;vote_sum&gt;-17&lt;/vote_sum&gt;
      &lt;/offer&gt;
    &lt;/vote_info&gt;
  &lt;/votes&gt;
&lt;/response&gt;</pre>
</div>
</div>
<div class="section" id="offer-statistics-counters">
<h3>Offer Statistics (counters)<a class="headerlink" href="#offer-statistics-counters" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="8%" />
<col width="45%" />
<col width="47%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Method</th>
<th class="head">Rest URI</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>GET</td>
<td>url/<strong>offers/statistics</strong></td>
<td>Return taxonomy with offer counters</td>
</tr>
</tbody>
</table>
<p>Sample JSON request:</p>
<div class="highlight-python"><pre>curl -s -X GET http://coupons.edu.teiath.gr/api/offers/statistics \
    -H &quot;Accept: application/json&quot;</pre>
</div>
<p>Sample JSON response:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>
    <span class="s">&quot;categories&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s">&quot;id&quot;</span><span class="p">:</span> <span class="s">&quot;1&quot;</span><span class="p">,</span>
            <span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="s">&quot;Φαγητό&quot;</span><span class="p">,</span>
            <span class="s">&quot;offer_count&quot;</span><span class="p">:</span> <span class="s">&quot;23&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s">&quot;id&quot;</span><span class="p">:</span> <span class="s">&quot;2&quot;</span><span class="p">,</span>
            <span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="s">&quot;Υπηρεσίες&quot;</span><span class="p">,</span>
            <span class="s">&quot;offer_count&quot;</span><span class="p">:</span> <span class="s">&quot;17&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s">&quot;id&quot;</span><span class="p">:</span> <span class="s">&quot;3&quot;</span><span class="p">,</span>
            <span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="s">&quot;Δραστηριότητες &amp; Χόμπι&quot;</span><span class="p">,</span>
            <span class="s">&quot;offer_count&quot;</span><span class="p">:</span> <span class="s">&quot;17&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s">&quot;id&quot;</span><span class="p">:</span> <span class="s">&quot;4&quot;</span><span class="p">,</span>
            <span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="s">&quot;Ένδυση &amp; Υπόδηση&quot;</span><span class="p">,</span>
            <span class="s">&quot;offer_count&quot;</span><span class="p">:</span> <span class="s">&quot;24&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s">&quot;id&quot;</span><span class="p">:</span> <span class="s">&quot;5&quot;</span><span class="p">,</span>
            <span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="s">&quot;Υγεία&quot;</span><span class="p">,</span>
            <span class="s">&quot;offer_count&quot;</span><span class="p">:</span> <span class="s">&quot;17&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s">&quot;id&quot;</span><span class="p">:</span> <span class="s">&quot;6&quot;</span><span class="p">,</span>
            <span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="s">&quot;Ταξίδια &amp; Εκδρομές&quot;</span><span class="p">,</span>
            <span class="s">&quot;offer_count&quot;</span><span class="p">:</span> <span class="s">&quot;18&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s">&quot;id&quot;</span><span class="p">:</span> <span class="s">&quot;7&quot;</span><span class="p">,</span>
            <span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="s">&quot;Διασκέδαση&quot;</span><span class="p">,</span>
            <span class="s">&quot;offer_count&quot;</span><span class="p">:</span> <span class="s">&quot;20&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s">&quot;id&quot;</span><span class="p">:</span> <span class="s">&quot;8&quot;</span><span class="p">,</span>
            <span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="s">&quot;Προϊόντα&quot;</span><span class="p">,</span>
            <span class="s">&quot;offer_count&quot;</span><span class="p">:</span> <span class="s">&quot;21&quot;</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="s">&quot;status_code&quot;</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
    <span class="s">&quot;total_offers&quot;</span><span class="p">:</span> <span class="mi">157</span><span class="p">,</span>
    <span class="s">&quot;my_stats&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">&quot;coupon_count&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s">&quot;vote_count&quot;</span><span class="p">:</span> <span class="n">null</span>
    <span class="p">},</span>
    <span class="s">&quot;types&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s">&quot;id&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
            <span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="s">&quot;limited&quot;</span><span class="p">,</span>
            <span class="s">&quot;offer_count&quot;</span><span class="p">:</span> <span class="s">&quot;64&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="s">&quot;happy hour&quot;</span><span class="p">,</span>
            <span class="s">&quot;offer_count&quot;</span><span class="p">:</span> <span class="s">&quot;38&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s">&quot;id&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="s">&quot;coupons&quot;</span><span class="p">,</span>
            <span class="s">&quot;offer_count&quot;</span><span class="p">:</span> <span class="s">&quot;55&quot;</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Sample XML response:</p>
<div class="highlight-python"><pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;response status_code=&quot;200&quot;&gt;
  &lt;total_offers&gt;102&lt;/total_offers&gt;
  &lt;types&gt;
    &lt;type&gt;
      &lt;id&gt;1&lt;/id&gt;
      &lt;name&gt;happy hour&lt;/name&gt;
      &lt;offer_count&gt;42&lt;/offer_count&gt;
    &lt;/type&gt;
    &lt;type&gt;
      &lt;id&gt;2&lt;/id&gt;
      &lt;name&gt;coupons&lt;/name&gt;
      &lt;offer_count&gt;24&lt;/offer_count&gt;
    &lt;/type&gt;
    &lt;type&gt;
      &lt;id&gt;3&lt;/id&gt;
      &lt;name&gt;limited&lt;/name&gt;
      &lt;offer_count&gt;36&lt;/offer_count&gt;
    &lt;/type&gt;
  &lt;/types&gt;
  &lt;categories&gt;
    &lt;category&gt;
      &lt;type&gt;
        &lt;id&gt;1&lt;/id&gt;
        &lt;name&gt;happy hour&lt;/name&gt;
        &lt;offer_count&gt;42&lt;/offer_count&gt;
      &lt;/type&gt;
      &lt;type&gt;
        &lt;id&gt;2&lt;/id&gt;
        &lt;name&gt;coupons&lt;/name&gt;
        &lt;offer_count&gt;24&lt;/offer_count&gt;
      &lt;/type&gt;
      &lt;type&gt;
        &lt;id&gt;3&lt;/id&gt;
        &lt;name&gt;limited&lt;/name&gt;
        &lt;offer_count&gt;36&lt;/offer_count&gt;
      &lt;/type&gt;
    &lt;/category&gt;
  &lt;/categories&gt;
  &lt;my_stats&gt;
    &lt;coupon_count/&gt;
    &lt;vote_count/&gt;
  &lt;/my_stats&gt;
&lt;/response&gt;</pre>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Για να επιστραφεί το πλήθος των ψήφων και το πλήθος των κουπονιών του χρήστη, πρέπει να έχει
επιτυχώς αυθεντικοποιηθεί στο σύστημα.</p>
</div>
<p>Πλήθος ψήφων/κουπονιών (JSON):</p>
<div class="highlight-python"><pre>&quot;my_stats&quot;: {
    &quot;coupon_count&quot;: 9,
    &quot;vote_count&quot;: 4
},</pre>
</div>
<p>Πλήθος ψήφων/κουπονιών (XML):</p>
<div class="highlight-python"><pre>&lt;my_stats&gt;
    &lt;coupon_count&gt;9&lt;/coupon_count&gt;
    &lt;vote_count&gt;4&lt;/vote_count&gt;
&lt;/my_stats&gt;</pre>
</div>
</div>
<div class="section" id="search">
<h3>Search<a class="headerlink" href="#search" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="9%" />
<col width="61%" />
<col width="30%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Method</th>
<th class="head">Rest URI</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>GET</td>
<td>url/<strong>search</strong>/<em>contains:{search-string}</em></td>
<td>Return search results</td>
</tr>
</tbody>
</table>
<p>Sample search using JSON:</p>
<div class="highlight-python"><pre>curl -X GET &quot;http://url/search/contains:εμπόριο&quot; \
    -H &quot;Accept: application/json&quot; -s</pre>
</div>
<p>Response:</p>
<div class="highlight-python"><pre>{
    &quot;companies&quot;: [
        {
            &quot;address&quot;: &quot;οδός Ρόδων 95&quot;,
            &quot;afm&quot;: &quot;000000012&quot;,
            &quot;created&quot;: &quot;2012-04-17 12:49:56&quot;,
            &quot;fax&quot;: &quot;2107654321&quot;,
            &quot;id&quot;: &quot;101&quot;,
            &quot;image_count&quot;: &quot;0&quot;,
            &quot;is_enabled&quot;: true,
            &quot;latitude&quot;: &quot;37.94471&quot;,
            &quot;longitude&quot;: &quot;23.76706&quot;,
            &quot;modified&quot;: &quot;2012-07-23 12:02:58&quot;,
            &quot;municipality_id&quot;: &quot;144&quot;,
            &quot;name&quot;: &quot;CQ ΕΜΠΟΡΙΟ ΑΠΟΘΗΚΕΥΣΗ ΔΙΑΝΟΜΗ ΠΡΟΙΟΝΤΩΝ ΚΑΙ ΠΑΡΟΧΗ ΥΠΗΡΕΣΙΩΝ ΣΥΣΚΕΥΑΣΙΑΣ ΤΥΠΟΠΟΙΗΣΗΣ ΚΑΘΑΡΙΣΜΩΝ ΜΟΝΟΠΡΟΣΩΠΗ ΕΤΑΙΡΕΙΑ&quot;
            &quot;phone&quot;: &quot;2101234567&quot;,
            &quot;postalcode&quot;: &quot;12345&quot;,
            &quot;service_type&quot;: &quot;Υπηρεσίες&quot;,
            &quot;user_id&quot;: &quot;101&quot;
        }
    ],
    &quot;offers&quot;: [
        {
            &quot;autoend&quot;: null,
            &quot;autostart&quot;: null,
            &quot;company_id&quot;: &quot;101&quot;,
            &quot;coupon_count&quot;: &quot;0&quot;,
            &quot;coupon_terms&quot;: null,
            &quot;created&quot;: &quot;2012-07-20 13:46:03&quot;,
            &quot;description&quot;: &quot;happy hour test&quot;,
            &quot;ended&quot;: null,
            &quot;id&quot;: &quot;275&quot;,
            &quot;image_count&quot;: &quot;0&quot;,
            &quot;is_spam&quot;: false,
            &quot;max_per_student&quot;: null,
            &quot;modified&quot;: &quot;2012-07-20 13:47:26&quot;,
            &quot;offer_category&quot;: &quot;Φαγητό&quot;,
            &quot;offer_hours&quot;: [
                {
                    &quot;day_id&quot;: &quot;1&quot;,
                    &quot;ending1&quot;: &quot;07:30:00&quot;,
                    &quot;ending2&quot;: &quot;22:00:00&quot;,
                    &quot;starting1&quot;: &quot;04:30:00&quot;,
                    &quot;starting2&quot;: &quot;16:00:00&quot;
                },
                {
                    &quot;day_id&quot;: &quot;2&quot;,
                    &quot;ending1&quot;: &quot;22:00:00&quot;,
                    &quot;starting1&quot;: &quot;06:00:00&quot;
                },
                {
                    &quot;day_id&quot;: &quot;3&quot;,
                    &quot;ending1&quot;: &quot;18:00:00&quot;,
                    &quot;ending2&quot;: &quot;21:30:00&quot;,
                    &quot;starting1&quot;: &quot;16:30:00&quot;,
                    &quot;starting2&quot;: &quot;18:30:00&quot;
                },
                {
                    &quot;day_id&quot;: &quot;4&quot;,
                    &quot;ending1&quot;: &quot;14:00:00&quot;,
                    &quot;starting1&quot;: &quot;02:00:00&quot;
                }
            ],
            &quot;offer_state&quot;: &quot;active&quot;,
            &quot;offer_type&quot;: &quot;happy hour&quot;,
            &quot;started&quot;: &quot;2012-07-20 13:47:26&quot;,
            &quot;tags&quot;: &quot;derp&quot;,
            &quot;title&quot;: &quot;HH-test&quot;,
            &quot;total_quantity&quot;: null,
            &quot;vote_count&quot;: &quot;0&quot;,
            &quot;vote_minus&quot;: &quot;0&quot;,
            &quot;vote_plus&quot;: &quot;0&quot;,
            &quot;vote_sum&quot;: &quot;0&quot;
        },

[ ouput truncated ]
        { },
        { },
        { },
        { },
[ ouput truncated ]
    ],
    &quot;pagination&quot;: {
        &quot;count&quot;: 5,
        &quot;current&quot;: 5,
        &quot;limit&quot;: 10,
        &quot;nextPage&quot;: false,
        &quot;options&quot;: {
            &quot;conditions&quot;: []
        },
        &quot;order&quot;: null,
        &quot;page&quot;: 1,
        &quot;pageCount&quot;: 1,
        &quot;paramType&quot;: &quot;named&quot;,
        &quot;prevPage&quot;: false
    },
    &quot;status_code&quot;: 200
}</pre>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Η αναζήτηση πραγματοποιείται στα εξής πεδία:</p>
<dl class="last docutils">
<dt>Προσφορά:</dt>
<dd><ul class="first last simple">
<li>title</li>
<li>description</li>
<li>tags</li>
</ul>
</dd>
<dt>Εταιρία:</dt>
<dd><ul class="first last simple">
<li>name</li>
</ul>
</dd>
</dl>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">To αποτέλεσμα της ανατήτησης έχει το ίδιο format με το αποτέλεσμα της ενότητας <a class="reference internal" href="#offer-index-listing">Offer Index (listing)</a> .</p>
</div>
</div>
</div>
<span id="document-schema"></span><div class="section" id="coupons-schema">
<h2>Coupons Schema<a class="headerlink" href="#coupons-schema" title="Permalink to this headline">¶</a></h2>
<div class="section" id="xsd">
<h3>XSD<a class="headerlink" href="#xsd" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;xs:schema xmlns:xs=&quot;http://www.w3.org/2001/XMLSchema&quot;
    xmlns:tns=&quot;http://www.coupons.teiath.gr/schemas&quot;
    targetNamespace=&quot;http://www.coupons.teiath.gr/schemas&quot;&gt;

    &lt;!-- Email type --&gt;
    &lt;xs:simpleType name=&quot;email_type&quot;&gt;
        &lt;xs:restriction base=&quot;xs:string&quot;&gt;
            &lt;xs:pattern value=&quot;\w+([-+.&#x27;]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*&quot;/&gt;
        &lt;/xs:restriction&gt;
    &lt;/xs:simpleType&gt;

    &lt;!-- AFM --&gt;
    &lt;xs:simpleType name=&quot;afm_type&quot;&gt;
        &lt;xs:restriction base=&quot;xs:string&quot;&gt;
            &lt;xs:pattern value=&quot;\d{10}&quot;/&gt;
        &lt;/xs:restriction&gt;
    &lt;/xs:simpleType&gt;

    &lt;!-- Postal Code --&gt;
    &lt;xs:simpleType name=&quot;postal_code_type&quot;&gt;
        &lt;xs:restriction base=&quot;xs:string&quot;&gt;
            &lt;xs:pattern value=&quot;\d{5}&quot;/&gt;
        &lt;/xs:restriction&gt;
    &lt;/xs:simpleType&gt;

    &lt;!-- Photo --&gt;
    &lt;xs:simpleType name=&quot;photo_type&quot;&gt;
        &lt;xs:restriction base=&quot;xs:base64Binary&quot;/&gt;
    &lt;/xs:simpleType&gt;

    &lt;!-- An envelop for photos --&gt;
    &lt;xs:complexType name=&quot;array_of_photos_type&quot;&gt;
        &lt;xs:sequence&gt;
            &lt;xs:element name=&quot;photo&quot; type=&quot;tns:photo_type&quot; minOccurs=&quot;0&quot; maxOccurs=&quot;unbounded&quot;/&gt;
        &lt;/xs:sequence&gt;
    &lt;/xs:complexType&gt;

    &lt;!-- Coordinations --&gt;
    &lt;xs:complexType name=&quot;coordinations_type&quot;&gt;
        &lt;xs:sequence&gt;
            &lt;xs:element name=&quot;latitude&quot; type=&quot;xs:double&quot;/&gt;
            &lt;xs:element name=&quot;longtitude&quot; type=&quot;xs:double&quot;/&gt;
        &lt;/xs:sequence&gt;
    &lt;/xs:complexType&gt;

    &lt;!-- Address --&gt;
    &lt;xs:complexType name=&quot;address_type&quot;&gt;
        &lt;xs:sequence&gt;
            &lt;xs:element name=&quot;road&quot; type=&quot;xs:string&quot;/&gt;
            &lt;xs:element name=&quot;postal_code&quot; type=&quot;tns:postal_code_type&quot;/&gt;
            &lt;xs:element name=&quot;city&quot; type=&quot;xs:string&quot;/&gt;
            &lt;xs:element name=&quot;coordinations&quot; type=&quot;tns:coordinations_type&quot; minOccurs=&quot;0&quot;/&gt;
        &lt;/xs:sequence&gt;
    &lt;/xs:complexType&gt;

    &lt;!-- Day enumeration --&gt;
    &lt;xs:simpleType name=&quot;day_type&quot;&gt;
        &lt;xs:restriction base=&quot;xs:string&quot;&gt;
            &lt;xs:enumeration value=&quot;Δευτέρα&quot;/&gt;
            &lt;xs:enumeration value=&quot;Τρίτη&quot;/&gt;
            &lt;xs:enumeration value=&quot;Τετάρτη&quot;/&gt;
            &lt;xs:enumeration value=&quot;Πέμπτη&quot;/&gt;
            &lt;xs:enumeration value=&quot;Παρασκευή&quot;/&gt;
            &lt;xs:enumeration value=&quot;Σάββατο&quot;/&gt;
            &lt;xs:enumeration value=&quot;Κυριακή&quot;/&gt;
        &lt;/xs:restriction&gt;
    &lt;/xs:simpleType&gt;

    &lt;!-- Datetime range --&gt;
    &lt;xs:complexType name=&quot;datetime_range_type&quot;&gt;
        &lt;xs:sequence&gt;
            &lt;xs:element name=&quot;day&quot; type=&quot;tns:day_type&quot;/&gt;
            &lt;xs:element name=&quot;from&quot; type=&quot;xs:time&quot;/&gt;
            &lt;xs:element name=&quot;to&quot; type=&quot;xs:time&quot;/&gt;
        &lt;/xs:sequence&gt;
    &lt;/xs:complexType&gt;

    &lt;!-- Datetime range --&gt;
    &lt;xs:complexType name=&quot;array_of_datetime_ranges_type&quot;&gt;
        &lt;xs:sequence&gt;
            &lt;xs:element name=&quot;range&quot; type=&quot;tns:datetime_range_type&quot; minOccurs=&quot;0&quot; maxOccurs=&quot;1&quot;/&gt;
        &lt;/xs:sequence&gt;
    &lt;/xs:complexType&gt;

    &lt;!-- Core person data --&gt;
    &lt;xs:complexType name=&quot;person_type&quot;&gt;
        &lt;xs:sequence&gt;
            &lt;xs:element name=&quot;first_name&quot; type=&quot;xs:string&quot;/&gt;
            &lt;xs:element name=&quot;last_name&quot; type=&quot;xs:string&quot;/&gt;
            &lt;xs:element name=&quot;email&quot; type=&quot;tns:email_type&quot;/&gt;
            &lt;xs:element name=&quot;is_admin&quot; type=&quot;xs:boolean&quot;/&gt;
        &lt;/xs:sequence&gt;
        &lt;xs:attribute name=&quot;id&quot; type=&quot;xs:ID&quot; use=&quot;optional&quot;/&gt;
    &lt;/xs:complexType&gt;

    &lt;!-- Business --&gt;
    &lt;xs:complexType name=&quot;business_type&quot;&gt;
        &lt;xs:sequence&gt;
            &lt;xs:element name=&quot;username&quot; type=&quot;xs:string&quot;/&gt;
            &lt;xs:element name=&quot;password&quot; type=&quot;xs:string&quot;/&gt;
            &lt;xs:element name=&quot;name&quot; type=&quot;xs:string&quot;/&gt;
            &lt;xs:element name=&quot;afm&quot; type=&quot;tns:afm_type&quot;/&gt;
            &lt;xs:element name=&quot;email&quot; type=&quot;tns:email_type&quot;/&gt;
            &lt;xs:element name=&quot;phone&quot; type=&quot;xs:string&quot;/&gt;
            &lt;xs:element name=&quot;address&quot; type=&quot;tns:address_type&quot;/&gt;
            &lt;xs:element name=&quot;photos&quot; type=&quot;tns:array_of_photos_type&quot; minOccurs=&quot;0&quot;/&gt;
            &lt;xs:element name=&quot;opening_hours&quot; type=&quot;tns:array_of_datetime_ranges_type&quot;/&gt;
        &lt;/xs:sequence&gt;
        &lt;xs:attribute name=&quot;id&quot; type=&quot;xs:ID&quot; use=&quot;optional&quot;/&gt;
    &lt;/xs:complexType&gt;

    &lt;!-- An enevelope of multiple users --&gt;
    &lt;xs:complexType name=&quot;array_of_users_type&quot;&gt;
        &lt;xs:sequence&gt;
            &lt;xs:element name=&quot;user&quot; type=&quot;tns:person_type&quot; minOccurs=&quot;0&quot; maxOccurs=&quot;unbounded&quot;/&gt;
        &lt;/xs:sequence&gt;
    &lt;/xs:complexType&gt;

    &lt;!-- An enevelope of multiple businesses --&gt;
    &lt;xs:complexType name=&quot;array_of_businesses_type&quot;&gt;
        &lt;xs:sequence&gt;
            &lt;xs:element name=&quot;business&quot; type=&quot;tns:business_type&quot; minOccurs=&quot;0&quot; maxOccurs=&quot;unbounded&quot;/&gt;
        &lt;/xs:sequence&gt;
    &lt;/xs:complexType&gt;

    &lt;!-- A single up/down vote --&gt;
    &lt;xs:complexType name=&quot;vote_type&quot;&gt;
        &lt;xs:sequence&gt;
            &lt;xs:element name=&quot;user_id&quot; type=&quot;xs:IDREF&quot;/&gt;
            &lt;xs:element name=&quot;is_upvote&quot; type=&quot;xs:boolean&quot;/&gt;
        &lt;/xs:sequence&gt;
    &lt;/xs:complexType&gt;

    &lt;!-- An envelope for multiple votes --&gt;
    &lt;xs:complexType name=&quot;array_of_votes_type&quot;&gt;
        &lt;xs:sequence&gt;
            &lt;xs:element name=&quot;vote&quot; type=&quot;tns:vote_type&quot; minOccurs=&quot;0&quot; maxOccurs=&quot;unbounded&quot;/&gt;
        &lt;/xs:sequence&gt;
    &lt;/xs:complexType&gt;

    &lt;!-- Simple offer --&gt;
    &lt;xs:complexType name=&quot;offer_type&quot;&gt;
        &lt;xs:sequence&gt;
            &lt;xs:element name=&quot;title&quot; type=&quot;xs:string&quot;/&gt;
            &lt;xs:element name=&quot;description&quot; type=&quot;xs:string&quot;/&gt;
            &lt;xs:element name=&quot;date_begin&quot; type=&quot;xs:dateTime&quot;/&gt;
            &lt;xs:element name=&quot;date_end&quot; type=&quot;xs:dateTime&quot;/&gt;
            &lt;xs:element name=&quot;is_published&quot; type=&quot;xs:boolean&quot;/&gt;
            &lt;xs:element name=&quot;photos&quot; type=&quot;tns:array_of_photos_type&quot; minOccurs=&quot;0&quot;/&gt;
            &lt;xs:element name=&quot;votes&quot; type=&quot;tns:array_of_votes_type&quot;&gt;
                &lt;xs:unique name=&quot;one_vote_per_person&quot;&gt;
                    &lt;xs:selector xpath=&quot;*/vote&quot;&gt;&lt;/xs:selector&gt;
                    &lt;xs:field xpath=&quot;user_id&quot;&gt;&lt;/xs:field&gt;
                &lt;/xs:unique&gt;
            &lt;/xs:element&gt;
        &lt;/xs:sequence&gt;
        &lt;xs:attribute name=&quot;id&quot; type=&quot;xs:ID&quot; use=&quot;optional&quot;/&gt;
    &lt;/xs:complexType&gt;

    &lt;!-- Repeat offer --&gt;
    &lt;xs:complexType name=&quot;repeat_offer_type&quot;&gt;
        &lt;xs:complexContent&gt;
            &lt;xs:extension base=&quot;tns:offer_type&quot;&gt;
                &lt;xs:sequence&gt;
                    &lt;xs:element name=&quot;offer_range&quot; type=&quot;tns:array_of_datetime_ranges_type&quot;/&gt;
                &lt;/xs:sequence&gt;
            &lt;/xs:extension&gt;
        &lt;/xs:complexContent&gt;
    &lt;/xs:complexType&gt;

    &lt;!-- Reservation info for a single coupon --&gt;
    &lt;xs:complexType name=&quot;coupon_reservation_type&quot;&gt;
        &lt;xs:sequence&gt;
            &lt;xs:element name=&quot;user_id&quot; type=&quot;xs:IDREF&quot;/&gt;
            &lt;xs:element name=&quot;expiration_date&quot; type=&quot;xs:dateTime&quot; minOccurs=&quot;0&quot;/&gt;
        &lt;/xs:sequence&gt;
    &lt;/xs:complexType&gt;

    &lt;!-- An envelope for multiple coupon reservations --&gt;
    &lt;xs:complexType name=&quot;array_of_coupon_reservations_type&quot;&gt;
        &lt;xs:sequence&gt;
            &lt;xs:element name=&quot;reservation&quot; type=&quot;tns:coupon_reservation_type&quot; minOccurs=&quot;0&quot; maxOccurs=&quot;1&quot;/&gt;
        &lt;/xs:sequence&gt;
    &lt;/xs:complexType&gt;

    &lt;!-- Limited offer --&gt;
    &lt;xs:complexType name=&quot;limited_offer_type&quot;&gt;
        &lt;xs:complexContent&gt;
            &lt;xs:extension base=&quot;tns:offer_type&quot;&gt;
                &lt;xs:sequence&gt;
                    &lt;xs:element name=&quot;max_coupons&quot; type=&quot;xs:integer&quot;/&gt;
                    &lt;xs:element name=&quot;coupon_expiration_minutes&quot; type=&quot;xs:integer&quot; minOccurs=&quot;0&quot;/&gt;
                    &lt;xs:element name=&quot;coupon_reservations&quot; type=&quot;tns:array_of_coupon_reservations_type&quot;/&gt;
                &lt;/xs:sequence&gt;
            &lt;/xs:extension&gt;
        &lt;/xs:complexContent&gt;
    &lt;/xs:complexType&gt;
&lt;/xs:schema&gt;</pre>
</div>
</div>
<div class="section" id="sql">
<h3>SQL<a class="headerlink" href="#sql" title="Permalink to this headline">¶</a></h3>
<p>opendeals.sql</p>
<div class="highlight-python"><pre>SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE=&#x27;TRADITIONAL&#x27;;

DROP SCHEMA IF EXISTS `opendeals` ;
CREATE SCHEMA IF NOT EXISTS `opendeals` DEFAULT CHARACTER SET utf8 ;
USE `opendeals` ;

-- -----------------------------------------------------
-- Table `opendeals`.`counties`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `opendeals`.`counties` ;
CREATE  TABLE IF NOT EXISTS `opendeals`.`counties` (
  `id` INT NOT NULL AUTO_INCREMENT ,
  `name` MEDIUMTEXT NOT NULL ,
  PRIMARY KEY (`id`) )
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8;


-- -----------------------------------------------------
-- Table `opendeals`.`municipalities`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `opendeals`.`municipalities` ;
CREATE  TABLE IF NOT EXISTS `opendeals`.`municipalities` (
  `id` INT NOT NULL AUTO_INCREMENT ,
  `name` MEDIUMTEXT NOT NULL ,
  `county_id` INT NOT NULL ,
  PRIMARY KEY (`id`) ,
  INDEX `fk_municipalities_counties` (`county_id` ASC) ,
  CONSTRAINT `fk_municipalities_counties`
    FOREIGN KEY (`county_id`)
    REFERENCES `opendeals`.`counties` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8;


-- -----------------------------------------------------
-- Table `opendeals`.`offer_categories`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `opendeals`.`offer_categories` ;
CREATE  TABLE IF NOT EXISTS `opendeals`.`offer_categories` (
  `id` INT NOT NULL AUTO_INCREMENT ,
  `name` MEDIUMTEXT NOT NULL ,
  PRIMARY KEY (`id`) )
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8;


-- -----------------------------------------------------
-- Table `opendeals`.`days`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `opendeals`.`days` ;

CREATE  TABLE IF NOT EXISTS `opendeals`.`days` (
  `id` INT NOT NULL AUTO_INCREMENT ,
  `name` MEDIUMTEXT NOT NULL ,
  PRIMARY KEY (`id`) )
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8;


-- -----------------------------------------------------
-- Table `opendeals`.`users`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `opendeals`.`users` ;

CREATE  TABLE IF NOT EXISTS `opendeals`.`users` (
  `id` INT NOT NULL AUTO_INCREMENT ,
  `username` MEDIUMTEXT NOT NULL ,
  `password` MEDIUMTEXT NOT NULL ,
  `email` MEDIUMTEXT NOT NULL ,
  `token` MEDIUMTEXT NULL DEFAULT NULL ,
  `email_verified` TINYINT(1) NOT NULL DEFAULT FALSE ,
  `is_banned` TINYINT(1) NOT NULL DEFAULT FALSE ,
  `role` MEDIUMTEXT NOT NULL ,
  `terms_accepted` TINYINT(1) NOT NULL DEFAULT FALSE,
  `last_login` DATETIME NULL DEFAULT NULL,
  PRIMARY KEY (`id`) )
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8;


-- -----------------------------------------------------
-- Table `opendeals`.`companies`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `opendeals`.`companies` ;

CREATE  TABLE IF NOT EXISTS `opendeals`.`companies` (
  `id` INT NOT NULL AUTO_INCREMENT ,
  `name` MEDIUMTEXT NOT NULL ,
  `address` MEDIUMTEXT NULL DEFAULT NULL ,
  `postalcode` VARCHAR(5) NULL DEFAULT NULL ,
  `phone` VARCHAR(10) NOT NULL ,
  `fax` VARCHAR(10) NULL DEFAULT NULL ,
  `service_type` MEDIUMTEXT NULL DEFAULT NULL ,
  `afm` VARCHAR(9) NOT NULL ,
  `latitude` DOUBLE NULL DEFAULT NULL ,
  `longitude` DOUBLE NULL DEFAULT NULL ,
  `is_enabled` TINYINT(1) NOT NULL DEFAULT FALSE ,
  `user_id` INT NOT NULL ,
  `municipality_id` INT NULL DEFAULT NULL ,
  `image_count` INT NOT NULL DEFAULT 0 ,
  `work_hour_count` INT NOT NULL DEFAULT 0,
  `created` DATETIME NULL DEFAULT NULL ,
  `modified` DATETIME NULL DEFAULT NULL ,
  PRIMARY KEY (`id`) ,
  INDEX `fk_companies_users1` (`user_id` ASC) ,
  INDEX `fk_companies_municipalities` (`municipality_id` ASC) ,
  CONSTRAINT `fk_companies_users1`
    FOREIGN KEY (`user_id` )
    REFERENCES `opendeals`.`users` (`id` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_companies_municipalities`
    FOREIGN KEY (`municipality_id` )
    REFERENCES `opendeals`.`municipalities` (`id` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8;


-- -----------------------------------------------------
-- Table `opendeals`.`images`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `opendeals`.`images` ;

CREATE  TABLE IF NOT EXISTS `opendeals`.`images` (
  `id` INT NOT NULL AUTO_INCREMENT ,
  `name` MEDIUMTEXT NOT NULL ,
  `type` MEDIUMTEXT NOT NULL ,
  `size` INT NOT NULL DEFAULT 0,
  `size_thumb` INT NOT NULL DEFAULT 0,
  `error`INT NULL DEFAULT NULL ,
  `data` LONGBLOB NOT NULL ,
  `data_thumb` LONGBLOB NOT NULL ,
  `offer_id` INT NULL DEFAULT NULL ,
  `company_id` INT NULL DEFAULT NULL ,
  `image_category` INT NOT NULL ,
  `created` DATETIME NULL DEFAULT NULL ,
  `modified` DATETIME NULL DEFAULT NULL ,
  PRIMARY KEY (`id`) ,
  INDEX `fk_images_offers` (`offer_id` ASC) ,
  INDEX `fk_images_companies` (`company_id` ASC) ,
  CONSTRAINT `fk_images_offers`
    FOREIGN KEY (`offer_id`)
    REFERENCES `opendeals`.`offers` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_images_companies`
    FOREIGN KEY (`company_id`)
    REFERENCES `opendeals`.`companies` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8;


-- -----------------------------------------------------
-- Table `opendeals`.`offers`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `opendeals`.`offers` ;

CREATE  TABLE IF NOT EXISTS `opendeals`.`offers` (
  `id` INT NOT NULL AUTO_INCREMENT ,
  `title` TEXT NOT NULL ,
  `description` TEXT NULL DEFAULT NULL ,
  `started` DATETIME NULL DEFAULT NULL ,
  `ended` DATETIME NULL DEFAULT NULL ,
  `autostart` DATETIME NULL DEFAULT NULL ,
  `autoend` DATETIME NULL DEFAULT NULL ,
  `coupon_terms` TEXT NULL DEFAULT NULL ,
  `total_quantity` INT NOT NULL DEFAULT 0 ,
  `coupon_count` INT NOT NULL DEFAULT 0 ,
  `max_per_student` int(11) NOT NULL DEFAULT 0,
  `tags` MEDIUMTEXT NULL ,
  `offer_category_id` INT NOT NULL ,
  `offer_type_id` INT NOT NULL ,
  `company_id` INT NOT NULL ,
  `image_count` INT NOT NULL DEFAULT 0 ,
  `work_hour_count` INT NOT NULL DEFAULT 0 ,
  `offer_state_id` INT NOT NULL DEFAULT 1 ,
  `is_spam` TINYINT(1) NOT NULL DEFAULT 0 ,
  `vote_count` INT(11) NOT NULL DEFAULT 0 ,
  `vote_plus` INT(11) NOT NULL DEFAULT 0 ,
  `vote_minus` INT(11) NOT NULL DEFAULT 0 ,
  `created` DATETIME NULL DEFAULT NULL ,
  `modified` DATETIME NULL DEFAULT NULL ,
  PRIMARY KEY (`id`) ,
  INDEX `fk_offers_offer_categories` (`offer_category_id` ASC) ,
  INDEX `fk_offers_offer_types1` (`offer_type_id` ASC) ,
  INDEX `fk_offers_companies1` (`company_id` ASC) ,
  INDEX `fk_offers_offer_states` (`offer_state_id` ASC) ,
  CONSTRAINT `fk_offers_offer_categories`
    FOREIGN KEY (`offer_category_id` )
    REFERENCES `opendeals`.`offer_categories` (`id` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_offers_companies1`
    FOREIGN KEY (`company_id` )
    REFERENCES `opendeals`.`companies` (`id` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8;


-- -----------------------------------------------------
-- Table `opendeals`.`students`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `opendeals`.`students` ;

CREATE  TABLE IF NOT EXISTS `opendeals`.`students` (
  `id` INT NOT NULL AUTO_INCREMENT ,
  `firstname` MEDIUMTEXT NOT NULL ,
  `lastname` MEDIUMTEXT NOT NULL ,
  `receive_email` TINYINT(1) NOT NULL DEFAULT FALSE ,
  `user_id` INT NOT NULL ,
  `image_id` INT NULL DEFAULT NULL ,
  `created` DATETIME NULL DEFAULT NULL ,
  `modified` DATETIME NULL DEFAULT NULL ,
  PRIMARY KEY (`id`) ,
  INDEX `fk_students_users1` (`user_id` ASC) ,
  INDEX `fk_students_images` (`image_id` ASC) ,
  CONSTRAINT `fk_students_users1`
    FOREIGN KEY (`user_id` )
    REFERENCES `opendeals`.`users` (`id` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_students_images`
    FOREIGN KEY (`image_id` )
    REFERENCES `opendeals`.`images` (`id` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8;


-- -----------------------------------------------------
-- Table `opendeals`.`coupons`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `opendeals`.`coupons` ;

CREATE  TABLE IF NOT EXISTS `opendeals`.`coupons` (
  `id` INT NOT NULL AUTO_INCREMENT ,
  `serial_number` TEXT NOT NULL ,
  `created` DATETIME NULL DEFAULT NULL ,
  `modified` DATETIME NULL DEFAULT NULL ,
  `is_used` TINYINT(1)  NOT NULL DEFAULT 0 ,
  `offer_id` INT NOT NULL ,
  `student_id` INT NULL ,
  PRIMARY KEY (`id`) ,
  INDEX `fk_coupons_offers1` (`offer_id` ASC) ,
  INDEX `fk_coupons_students1` (`student_id` ASC) ,
  CONSTRAINT `fk_coupons_offers1`
    FOREIGN KEY (`offer_id` )
    REFERENCES `opendeals`.`offers` (`id` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_coupons_students1`
    FOREIGN KEY (`student_id` )
    REFERENCES `opendeals`.`students` (`id` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8;


-- -----------------------------------------------------
-- Table `opendeals`.`work_hours`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `opendeals`.`work_hours` ;

CREATE  TABLE IF NOT EXISTS `opendeals`.`work_hours` (
  `id` INT NOT NULL AUTO_INCREMENT ,
  `day_id` INT NOT NULL ,
  `starting` TIME NOT NULL ,
  `ending` TIME NOT NULL ,
  `company_id` INT NULL ,
  `offer_id` INT NULL ,
  PRIMARY KEY (`id`) ,
  INDEX `fk_work_hours_days1` (`day_id` ASC) ,
  INDEX `fk_work_hours_companies1` (`company_id` ASC) ,
  INDEX `fk_work_hours_offers1` (`offer_id` ASC) ,
  CONSTRAINT `fk_work_hours_days1`
    FOREIGN KEY (`day_id` )
    REFERENCES `opendeals`.`days` (`id` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_work_hours_companies1`
    FOREIGN KEY (`company_id` )
    REFERENCES `opendeals`.`companies` (`id` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_work_hours_offers1`
    FOREIGN KEY (`offer_id` )
    REFERENCES `opendeals`.`offers` (`id` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8;


-- -----------------------------------------------------
-- Table `opendeals`.`votes`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `opendeals`.`votes` ;

CREATE  TABLE IF NOT EXISTS `opendeals`.`votes` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `offer_id` int(11) NOT NULL,
  `student_id` int(11) NOT NULL,
  `vote` tinyint(1) NOT NULL COMMENT &#x27;0 negative, 1 positive&#x27;,
  PRIMARY KEY (`id`) ,
  INDEX `fk_votes_offers1` (`offer_id` ASC) ,
  INDEX `fk_votes_students1` (`student_id` ASC) ,
  CONSTRAINT `fk_votes_offers1`
    FOREIGN KEY (`offer_id` )
    REFERENCES `opendeals`.`offers` (`id` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_votes_students1`
    FOREIGN KEY (`student_id` )
    REFERENCES `opendeals`.`students` (`id` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8;


-- -----------------------------------------------------
-- Table `opendeals`.`distances`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `opendeals`.`distances`;

CREATE TABLE IF NOT EXISTS `opendeals`.`distances` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `user_id` int(11) NOT NULL,
  `company_id` int(11) NOT NULL,
  `radius` int(11) NOT NULL,
  `distance` double NOT NULL,
  PRIMARY KEY (`id`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8;


DELIMITER //
CREATE FUNCTION `opendeals`.`geodist` (fromlat DOUBLE, fromlng DOUBLE, tolat DOUBLE, tolng DOUBLE)
RETURNS DOUBLE
DETERMINISTIC
BEGIN
DECLARE latfrom,latto,latdiff,lngdiff DOUBLE;
DECLARE lathvr,lnghvr,root,dist DOUBLE;
DECLARE r INT;
SET r = 6371;
SET latfrom = radians(fromlat);
SET latto = radians(tolat);
SET latdiff = radians(tolat - fromlat);
SET lngdiff = radians(tolng - fromlng);
SET lathvr = sin(latdiff / 2) * sin(latdiff / 2);
SET lnghvr = sin(lngdiff / 2) * sin(lngdiff / 2);
SET root = sqrt(lathvr + cos(latfrom) * cos(latto) * sin(lnghvr));
SET dist = 2 * r * asin(root);
RETURN dist;
END //


DELIMITER //
CREATE PROCEDURE `opendeals`.`updatedistances` (IN uid INT, IN lat DOUBLE, IN lng DOUBLE, IN r INT)
BEGIN
DELETE FROM `opendeals`.`distances` WHERE `distances`.`user_id` = uid;
INSERT INTO `opendeals`.`distances` (user_id, company_id, radius, distance)
SELECT users.id, companies.id, r, geodist(lat,lng,companies.latitude,companies.longitude) AS d
FROM users,companies
WHERE users.id = uid
GROUP BY companies.id
HAVING d &gt; 0 AND d &lt; r
ORDER BY d ASC;
END //


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;</pre>
</div>
<p>insert_counties.sql</p>
<div class="highlight-python"><pre>LOAD DATA LOCAL INFILE &quot;counties.csv&quot;
INTO TABLE `opendeals`.`counties`
CHARACTER SET &#x27;UTF8&#x27;
FIELDS TERMINATED BY &#x27;,&#x27;
LINES TERMINATED BY &#x27;\n&#x27;
IGNORE 1 LINES
(id, name);</pre>
</div>
<p>insert_days.sql</p>
<div class="highlight-python"><pre>INSERT INTO `days` (`id`,`name`) VALUES (NULL,&#x27;Δευτέρα&#x27;);
INSERT INTO `days` (`id`,`name`) VALUES (NULL,&#x27;Τρίτη&#x27;);
INSERT INTO `days` (`id`,`name`) VALUES (NULL,&#x27;Τετάρτη&#x27;);
INSERT INTO `days` (`id`,`name`) VALUES (NULL,&#x27;Πέμπτη&#x27;);
INSERT INTO `days` (`id`,`name`) VALUES (NULL,&#x27;Παρασκευή&#x27;);
INSERT INTO `days` (`id`,`name`) VALUES (NULL,&#x27;Σάββατο&#x27;);
INSERT INTO `days` (`id`,`name`) VALUES (NULL,&#x27;Κυριακή&#x27;);</pre>
</div>
<p>insert_municipalities.sql</p>
<div class="highlight-python"><pre>LOAD DATA LOCAL INFILE &quot;municipalities.csv&quot;
INTO TABLE `opendeals`.`municipalities`
CHARACTER SET &#x27;UTF8&#x27;
FIELDS TERMINATED BY &#x27;,&#x27;
LINES TERMINATED BY &#x27;\n&#x27;
IGNORE 1 LINES
(id, county_id, name);</pre>
</div>
<p>insert_offer_categores.sql</p>
<div class="highlight-python"><pre>INSERT INTO `offer_categories` (`id`,`name`) VALUES (NULL,&#x27;Φαγητό&#x27;);
INSERT INTO `offer_categories` (`id`,`name`) VALUES (NULL,&#x27;Υπηρεσίες&#x27;);
INSERT INTO `offer_categories` (`id`,`name`) VALUES (NULL,&#x27;Δραστηριότητες &amp; Χόμπι&#x27;);
INSERT INTO `offer_categories` (`id`,`name`) VALUES (NULL,&#x27;Ένδυση &amp; Υπόδηση&#x27;);
INSERT INTO `offer_categories` (`id`,`name`) VALUES (NULL,&#x27;Υγεία&#x27;);
INSERT INTO `offer_categories` (`id`,`name`) VALUES (NULL,&#x27;Ταξίδια &amp; Εκδρομές&#x27;);
INSERT INTO `offer_categories` (`id`,`name`) VALUES (NULL,&#x27;Διασκέδαση&#x27;);
INSERT INTO `offer_categories` (`id`,`name`) VALUES (NULL,&#x27;Προϊόντα&#x27;);</pre>
</div>
<p>counties.csv</p>
<div class="highlight-python"><pre>id,name
1,Δράμας
2,Έβρου
3,Καβάλας
4,Ξάνθης
5,Ροδόπης
6,Ημαθίας
7,Θεσσαλονίκης
8,Κιλκίς
9,Πέλλης
10,Πιερίας
11,Σερρών
12,Χαλκιδικής
13,Γρεβενών
14,Καστοριάς
15,Κοζάνης
16,Φλωρίνης
17,Άρτης
18,Θεσπρωτίας
19,Ιωαννίνων
20,Πρεβέζης
21,Καρδίτσης
22,Λαρίσης
23,Μαγνησίας
24,Τρικάλων
25,Ζακύνθου
26,Κερκύρας
27,Κεφαλληνίας
28,Λευκάδος
29,Αιτωλοακαρνανίας
30,Αχαϊας
31,Ηλείας
32,Βοιωτίας
33,Ευβοίας
34,Ευρυτανίας
35,Φθιώτιδος
36,Φωκίδος
37,Αττικής-Βορείου Τομέα Αθηνών
38,Αττικής-Δυτικού Τομέα Αθηνών
39,Αττικής-Κεντρικού Τομέα Αθηνών
40,Αττικής-Νοτίου Τομέα Αθηνών
41,Αττικής-Ανατολικής Αττικής
42,Αττικής-Δυτικής Αττικής
43,Αττικής-Πειραιώς
44,Αττικής-Νήσων
45,Αργολίδος
46,Αρκαδίας
47,Κορινθίας
48,Λακωνίας
49,Μεσσηνίας
50,Λέσβου
51,Σάμου
52,Χίου
53,Κυκλάδων
54,Δωδεκανήσου
55,Ηρακλείου
56,Λασιθίου
57,Ρεθύμνης
58,Χανίων</pre>
</div>
<p>municipalities.csv</p>
<div class="highlight-python"><pre>id,county_id,name
1,1,Δοξάτου
2,1,Δράμας
3,1,Κάτω Νευροκοπίου
4,1,Παρανεστίου
5,1,Προσοτσάνης
6,2,Αλεξανδρούπολης
7,2,Διδυμοτείχου
8,2,Ορεστιάδας
9,2,Σαμοθράκης
10,2,Σουφλίου
11,3,Θάσου
12,3,Καβάλας
13,3,Νέστου
14,3,Παγγαίου
15,4,Αβδήρων
16,4,Μύκης
17,4,Ξάνθης
18,4,Τοπείρου
19,5,Αρριανών
20,5,Ιάσμου
21,5,Κομοτηνής
22,5,Μαρωνείας - Σαπών
23,6,Αλεξάνδρειας
24,6,Βέροιας
25,6,Νάουσας
26,7,Αμπελοκήπων - Μενεμένης
27,7,Βόλβης
28,7,Δέλτα
29,7,Θερμαϊκού
30,7,Θέρμης
31,7,Θεσσαλονίκης
32,7,Καλαμαριάς
33,7,Κορδελιού - Ευόσμου
34,7,Λαγκαδά
35,7,Νέαπολης - Συκεών
36,7,Παύλου Μελά
37,7,Πυλαίας - Χορτιάτη
38,7,Χαλκηδόνος
39,7,Ωραιοκάστρου
40,8,Κιλκίς
41,8,Παιονίας
42,9,Αλμωπίας
43,9,Έδεσσας
44,9,Πέλλας
45,9,Σκύδρας
46,10,Δίου - Ολύμπου
47,10,Κατερίνης
48,10,Πύδνας - Κολινδρού
49,11,Αμφίπολης
50,11,Βισαλτίας
51,11,Εμμανουήλ Παππά
52,11,Ηρακλείας
53,11,Νέας Ζίχνης
54,11,Σερρών
55,11,Σιντικής
56,12,Αριστοτέλη
57,12,Κασσάνδρας
58,12,Νέας Προποντίδας
59,12,Πολυγύρου
60,12,Σιθωνίας
61,13,Γρεβενών
62,13,Δεσκάτης
63,14,Καστοριάς
64,14,Νεστορίου
65,14,Ορεστίδος
66,15,Βοίου
67,15,Εορδαίας
68,15,Κοζάνης
69,15,Σερβίων - Βελβεντού
70,16,Αμυνταίου
71,16,Πρεσπών
72,16,Φλώρινας
73,17,Αρταίων
74,17,Γεωργίου Καραϊσκάκη
75,17,Κεντρικών Τζουμέρκων
76,17,Νικολάου Σκουφά
77,18,Ηγουμενίτσας
78,18,Σουλίου
79,18,Φιλιατών
80,19,Βορείων Τζουμέρκων
81,19,Δωδώνης
82,19,Ζαγορίου
83,19,Ζίτσας
84,19,Ιωαννιτών
85,19,Κόνιτσας
86,19,Μετσόβου
87,19,Πωγωνίου
88,20,Ζηρού
89,20,Πάργας
90,20,Πρέβεζας
91,21,Αργιθέας
92,21,Καρδίτσας
93,21,Λίμνης Πλαστήρα
94,21,Μουζακίου
95,21,Παλαμά
96,21,Σοφάδων
97,22,Αγιάς
98,22,Ελασσόνας
99,22,Κιλελέρ
100,22,Λαρισαίων
101,22,Δ.Τεμπών
102,22,Τυρνάβου
103,22,Φαρσάλων
104,23,Αλμυρού
105,23,Βόλου
106,23,Ζαγοράς - Μουρεσίου
107,23,Νοτίου Πηλίου
108,23,Ρήγα Φερραίου
109,23,Αλοννήσου
110,23,Σκιάθου
111,23,Σκοπέλου
112,24,Καλαμπάκας
113,24,Πύλης
114,24,Τρικκαίων
115,24,Φαρκαδόνας
116,25,Ζακύνθου
117,26,Κέρκυρας
118,26,Παξών
119,27,Κεφαλονιάς
120,27,Ιθάκης
121,28,Λευκάδος
122,28,Μεγανησίου
123,29,Αγρινίου
124,29,Άκτιου - Βόνιτσας
125,29,Αμφιλοχίας
126,29,Θέρμου
127,29,Ιεράς Πόλης Μεσολογγίου
128,29,Ναυπακτίας
129,29,Ξηρομέρου
130,30,Αιγιαλείας
131,30,Δυτικής Αχαΐας
132,30,Ερυμάνθου
133,30,Καλαβρύτων
134,30,Πατρέων
135,31,Ανδραβίδας - Κυλλήνης
136,31,Ανδρίτσαινας - Κρεστένων
137,31,Αρχαίας Ολυμπίας
138,31,Ζαχάρως
139,31,Ήλιδας
140,31,Πηνειού
141,31,Πύργου
142,32,Αλιάρτου
143,32,Διστόμου-Αράχοβας - Αντίκυρας
144,32,Θηβαίων
145,32,Λεβαδέων
146,32,Ορχομενού
147,32,Τανάγρας
148,33,Διρφύων - Μεσσαπίων
149,33,Ερέτριας
150,33,Ιστιαίας - Αιδηψού
151,33,Καρύστου
152,33,Κύμης - Αλιβερίου
153,33,Μαντουδίου - Λίμνης - Αγίας Άννας
154,33,Σκύρου
155,33,Χαλκιδέων
156,34,Καρπενησίου
157,35,Μώλου - Αγίου Κωνσταντίνου
158,35,Αμφίκλειας - Ελάτειας
159,35,Λοκρών
160,35,Δομοκού
161,35,Λαμιέων
162,35,Μακρακώμης
163,35,Στυλίδος
164,36,Δελφών
165,36,Δωρίδος
166,37,Αγίας Παρασκευής
167,37,Αμαρουσίου
168,37,Βριλησσίων
169,37,Ηρακλείου
170,37,Κηφισιάς
171,37,Λυκόβρυσης - Πεύκης
172,37,Μεταμορφώσεως
173,37,Νέας Ιωνίας
174,37,Παπάγου - Χαλαργού
175,37,Πεντέλης
176,37,Φιλοθέης - Ψυχικού
177,37,Χαλανδρίου
178,38,Αγίας Βαρβάρας
179,38,Αγίων Αναργύρων - Καματερού
180,38,Αιγάλεω
181,38,Ιλίου
182,38,Περιστερίου
183,38,Πετρούπολης
184,38,Χαϊδαρίου
185,39,Αθηναίων
186,39,Βύρωνος
187,39,Γαλατσίου
188,39,Δάφνης - Υμηττού
189,39,Ζωγράφου
190,39,Ηλιουπόλεως
191,39,Καισαριανής
192,39,Φιλαδέλφειας - Χαλκηδόνος
193,40,Αγίου Δημητρίου
194,40,Αλίμου
195,40,Γλυφάδας
196,40,Ελληνικού - Αργυρούπολης
197,40,Καλλιθέας
198,40,Μοσχάτου - Ταύρου
199,40,Νέας Σμύρνης
200,40,Παλαιού Φαλήρου
201,41,Αχαρνών
202,41,Βάρης - Βούλας - Βουλιαγμένης
203,41,Διονύσου
204,41,Κρωπίας
205,41,Λαυρεωτικής
206,41,Μαραθώνος
207,41,Μαρκοπούλου Μεσογαίας
208,41,Παιανίας
209,41,Παλλήνης
210,41,Ραφήνας - Πικερμίου
211,41,Σαρωνικού
212,41,Σπάτων - Αρτέμιδος
213,41,Ωρωπίων
214,42,Ασπροπύργου
215,42,Ελευσίνας
216,42,Μάνδρας - Ειδυλλίας
217,42,Μεγαρέων
218,42,Φυλής
219,43,Κερατσινίου - Δραπετσώνας
220,43,Κορυδαλλού
221,43,Νικαίας - Αγίου Ιωάννου Ρέντη
222,43,Πειραιώς
223,43,Περάματος
224,44,Αγκιστρίου
225,44,Αίγινας
226,44,Κυθήρων
227,44,Πόρου
228,44,Σαλαμίνας
229,44,Σπετσών
230,44,Τροιζηνίας
231,44,Ύδρας
232,45,Άργους - Μυκηνών
233,45,Επιδαύρου
234,45,Ερμιονόδας
235,45,Ναυπλιέων
236,46,Βόρειας Κυνουρίας
237,46,Γόρτυνος
238,46,Μεγαλόπολης
239,46,Νότιας Κυνουρίας
240,46,Τρίπολης
241,47,Βέλου - Βόχας
242,47,Κορινθίων
243,47,Λουτρακίου - Αγ. Θεοδώρων
244,47,Νεμέας
245,47,Ξυλοκάστρου - Ευρωστίνης
246,47,Σικυωνίων
247,48,Ανατολικής Μάνης
248,48,Ελαφονήσου
249,48,Ευρώτα
250,48,Μονεμβασιάς
251,48,Σπάρτης
252,49,Δυτικής Μάνης
253,49,Καλαμάτας
254,49,Μεσσήνης
255,49,Οιχαλίας
256,49,Πύλου - Νέστορος
257,49,Τριφυλίας
258,50,Λέσβου
259,50,Αγίου Ευστρατίου
260,50,Λήμνου
261,51,Σάμου
262,51,Ικαρίας
263,51,Φούρνων Κορσέων
264,52,Οινουσσών
265,52,Χίου
266,52,Ψαρών
267,53,Άνδρου
268,53,Ανάφης
269,53,Θήρας
270,53,Ιητών
271,53,Σικίνου
272,53,Φολέγανδρου
273,53,Κέας
274,53,Κύθνου
275,53,Κιμώλου
276,53,Μήλου
277,53,Σερίφου
278,53,Σίφνου
279,53,Μυκόνου
280,53,Αμοργού
281,53,Νάξου  Μικρών Κυκλάδων
282,53,Αντιπάρου
283,53,Πάρου
284,53,Σύρου - Ερμούπολης
285,53,Τήνου
286,54,Αγαθονησίου
287,54,Αστυπάλαιας
288,54,Καλυμνίων
289,54,Καρπάθου
290,54,Κάσου
291,54,Λειψών
292,54,Λέρου
293,54,Πάτμου
294,54,Κώ
295,54,Νισύρου
296,54,Μεγίστης
297,54,Ρόδου
298,54,Σύμης
299,54,Τήλου
300,54,Χάλκης
301,55,Αρχανών - Αστερουσίων
302,55,Βιάννου
303,55,Γόρτυνας
304,55,Ηρακλείου
305,55,Μαλεβιζίου
306,55,Μινώα Πεδιάδας
307,55,Φαιστού
308,55,Χερσονήσου
309,56,Αγίου Νικολάου
310,56,Ιεράπετρας
311,56,Οροπεδίου Λασιθίου
312,56,Σητείας
313,57,Αγίου Βασιλείου
314,57,Αμάριου
315,57,Ανωγείων
316,57,Μυλοποτάμου
317,57,Ρεθύμνης
318,58,Αποκορώνου
319,58,Γαύδου
320,58,Καντάνου - Σέλινου
321,58,Κισσάμου
322,58,Πλατανιά
323,58,Σφακίων
324,58,Χανίων</pre>
</div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html#document-index">Table Of Contents</a></h3>
  <ul>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-installation">Coupons Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#dependencies">Dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#get-source-code">Get source code</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#deploy">Deploy</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#database">Database</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#cron-scripts">Cron scripts</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-api">Coupons API reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#summary">Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#login">Login</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#offer-index-listing">Offer Index (listing)</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#request-options">Request options</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#offer-types">Offer Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#offer-categories">Offer Categories</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#offer-view">Offer View</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#coupon-view">Coupon View</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#coupon-index">Coupon Index</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#grab-coupon">Grab Coupon</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#coupon-release-reinsert">Coupon release (reinsert)</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#set-coordinates">Set coordinates</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#set-search-radius">Set search radius</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#offer-vote">Offer Vote</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#user-votes-listing">User Votes (listing)</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#offer-statistics-counters">Offer Statistics (counters)</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#search">Search</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-schema">Coupons Schema</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#xsd">XSD</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#sql">SQL</a></li>
</ul>
</li>
</ul>

<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li><a href="index.html#document-index">coupons 1.0.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, TEI of Athens.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>
